<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>SUCKED BloG</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/img/logo.ico">
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.35bcedcf.css" as="style"><link rel="preload" href="/assets/js/app.42575a28.js" as="script"><link rel="preload" href="/assets/js/2.0d7d09b8.js" as="script"><link rel="preload" href="/assets/js/109.35619cf9.js" as="script"><link rel="prefetch" href="/assets/js/10.1a30ebe5.js"><link rel="prefetch" href="/assets/js/100.022f696a.js"><link rel="prefetch" href="/assets/js/101.06eb0acb.js"><link rel="prefetch" href="/assets/js/102.e944c220.js"><link rel="prefetch" href="/assets/js/103.45b9da9a.js"><link rel="prefetch" href="/assets/js/104.cf53f5d1.js"><link rel="prefetch" href="/assets/js/105.200d7fe5.js"><link rel="prefetch" href="/assets/js/106.a0cc3502.js"><link rel="prefetch" href="/assets/js/107.4a71d17e.js"><link rel="prefetch" href="/assets/js/108.d7a39a75.js"><link rel="prefetch" href="/assets/js/11.f78ae8b3.js"><link rel="prefetch" href="/assets/js/110.f667d72e.js"><link rel="prefetch" href="/assets/js/111.de83ce6f.js"><link rel="prefetch" href="/assets/js/112.417d40bf.js"><link rel="prefetch" href="/assets/js/113.0f26c1ca.js"><link rel="prefetch" href="/assets/js/114.c7014acb.js"><link rel="prefetch" href="/assets/js/115.b502c0f1.js"><link rel="prefetch" href="/assets/js/116.10fb230e.js"><link rel="prefetch" href="/assets/js/117.f7cb9e2a.js"><link rel="prefetch" href="/assets/js/118.978d3075.js"><link rel="prefetch" href="/assets/js/119.09272191.js"><link rel="prefetch" href="/assets/js/12.140aa2af.js"><link rel="prefetch" href="/assets/js/120.32b5dbd7.js"><link rel="prefetch" href="/assets/js/121.8d618bbb.js"><link rel="prefetch" href="/assets/js/122.dcd4190d.js"><link rel="prefetch" href="/assets/js/123.2ee061d1.js"><link rel="prefetch" href="/assets/js/124.5a3760a7.js"><link rel="prefetch" href="/assets/js/125.a874a4bc.js"><link rel="prefetch" href="/assets/js/126.c6c6b7e6.js"><link rel="prefetch" href="/assets/js/127.38c35051.js"><link rel="prefetch" href="/assets/js/128.8d775ac8.js"><link rel="prefetch" href="/assets/js/129.6100ddb1.js"><link rel="prefetch" href="/assets/js/13.b2a6e590.js"><link rel="prefetch" href="/assets/js/130.9a83da2a.js"><link rel="prefetch" href="/assets/js/131.22de7670.js"><link rel="prefetch" href="/assets/js/132.f88798bf.js"><link rel="prefetch" href="/assets/js/133.925bbfed.js"><link rel="prefetch" href="/assets/js/134.481fad71.js"><link rel="prefetch" href="/assets/js/135.c3efb09b.js"><link rel="prefetch" href="/assets/js/136.758c447a.js"><link rel="prefetch" href="/assets/js/137.dcde1032.js"><link rel="prefetch" href="/assets/js/138.616a346b.js"><link rel="prefetch" href="/assets/js/139.b58dd07f.js"><link rel="prefetch" href="/assets/js/14.15374560.js"><link rel="prefetch" href="/assets/js/140.62b4c7ea.js"><link rel="prefetch" href="/assets/js/15.ffd155fa.js"><link rel="prefetch" href="/assets/js/16.feb1b022.js"><link rel="prefetch" href="/assets/js/17.6d491eb6.js"><link rel="prefetch" href="/assets/js/18.03ddaa95.js"><link rel="prefetch" href="/assets/js/19.021bbcc8.js"><link rel="prefetch" href="/assets/js/20.8aa708b0.js"><link rel="prefetch" href="/assets/js/21.59d7a21e.js"><link rel="prefetch" href="/assets/js/22.21597439.js"><link rel="prefetch" href="/assets/js/23.77303f0b.js"><link rel="prefetch" href="/assets/js/24.0789ed5b.js"><link rel="prefetch" href="/assets/js/25.244a12a8.js"><link rel="prefetch" href="/assets/js/26.a6ee95e4.js"><link rel="prefetch" href="/assets/js/27.9e0f0e9d.js"><link rel="prefetch" href="/assets/js/28.189031c5.js"><link rel="prefetch" href="/assets/js/29.b3100d33.js"><link rel="prefetch" href="/assets/js/3.2a5d4cd5.js"><link rel="prefetch" href="/assets/js/30.fe8fe8c0.js"><link rel="prefetch" href="/assets/js/31.86fec3f7.js"><link rel="prefetch" href="/assets/js/32.24cac061.js"><link rel="prefetch" href="/assets/js/33.f1db2ed0.js"><link rel="prefetch" href="/assets/js/34.c220692f.js"><link rel="prefetch" href="/assets/js/35.9e7b4779.js"><link rel="prefetch" href="/assets/js/36.0cb1d1bc.js"><link rel="prefetch" href="/assets/js/37.7d1fcf79.js"><link rel="prefetch" href="/assets/js/38.bc9bc4b3.js"><link rel="prefetch" href="/assets/js/39.10801a2a.js"><link rel="prefetch" href="/assets/js/4.b4d9a5aa.js"><link rel="prefetch" href="/assets/js/40.c980543d.js"><link rel="prefetch" href="/assets/js/41.3f4581d8.js"><link rel="prefetch" href="/assets/js/42.60b85cdf.js"><link rel="prefetch" href="/assets/js/43.1338528d.js"><link rel="prefetch" href="/assets/js/44.786fc51f.js"><link rel="prefetch" href="/assets/js/45.d65f6744.js"><link rel="prefetch" href="/assets/js/46.543c2b26.js"><link rel="prefetch" href="/assets/js/47.59f19ed2.js"><link rel="prefetch" href="/assets/js/48.60de6b25.js"><link rel="prefetch" href="/assets/js/49.f3df62ef.js"><link rel="prefetch" href="/assets/js/5.013522c1.js"><link rel="prefetch" href="/assets/js/50.fd9871d6.js"><link rel="prefetch" href="/assets/js/51.1fb1863e.js"><link rel="prefetch" href="/assets/js/52.c06ce3f3.js"><link rel="prefetch" href="/assets/js/53.a3d55203.js"><link rel="prefetch" href="/assets/js/54.89ac64bc.js"><link rel="prefetch" href="/assets/js/55.ccf38d1e.js"><link rel="prefetch" href="/assets/js/56.ffb8595b.js"><link rel="prefetch" href="/assets/js/57.5f1bd695.js"><link rel="prefetch" href="/assets/js/58.7463616d.js"><link rel="prefetch" href="/assets/js/59.ea4eb5dd.js"><link rel="prefetch" href="/assets/js/6.72ad7c85.js"><link rel="prefetch" href="/assets/js/60.a2add219.js"><link rel="prefetch" href="/assets/js/61.3eae0362.js"><link rel="prefetch" href="/assets/js/62.801d1658.js"><link rel="prefetch" href="/assets/js/63.b47a17bb.js"><link rel="prefetch" href="/assets/js/64.d5e2bdea.js"><link rel="prefetch" href="/assets/js/65.24d540f4.js"><link rel="prefetch" href="/assets/js/66.09a1ae52.js"><link rel="prefetch" href="/assets/js/67.75bd38e7.js"><link rel="prefetch" href="/assets/js/68.1fe6956e.js"><link rel="prefetch" href="/assets/js/69.d3306c2d.js"><link rel="prefetch" href="/assets/js/7.60760bb7.js"><link rel="prefetch" href="/assets/js/70.95aa4503.js"><link rel="prefetch" href="/assets/js/71.7065ebf0.js"><link rel="prefetch" href="/assets/js/72.55ae5081.js"><link rel="prefetch" href="/assets/js/73.c7624eee.js"><link rel="prefetch" href="/assets/js/74.63bcc7bd.js"><link rel="prefetch" href="/assets/js/75.e2731e20.js"><link rel="prefetch" href="/assets/js/76.1711af80.js"><link rel="prefetch" href="/assets/js/77.f1c4e2d3.js"><link rel="prefetch" href="/assets/js/78.900bc856.js"><link rel="prefetch" href="/assets/js/79.a1b8c47b.js"><link rel="prefetch" href="/assets/js/8.0c261cf2.js"><link rel="prefetch" href="/assets/js/80.7cf435bf.js"><link rel="prefetch" href="/assets/js/81.fa33b2af.js"><link rel="prefetch" href="/assets/js/82.cdabd386.js"><link rel="prefetch" href="/assets/js/83.879fc50c.js"><link rel="prefetch" href="/assets/js/84.7e460788.js"><link rel="prefetch" href="/assets/js/85.339356d5.js"><link rel="prefetch" href="/assets/js/86.d526418c.js"><link rel="prefetch" href="/assets/js/87.12877e38.js"><link rel="prefetch" href="/assets/js/88.d5a7d193.js"><link rel="prefetch" href="/assets/js/89.2f4a62c2.js"><link rel="prefetch" href="/assets/js/9.50eda380.js"><link rel="prefetch" href="/assets/js/90.6d83f5bf.js"><link rel="prefetch" href="/assets/js/91.f3364825.js"><link rel="prefetch" href="/assets/js/92.158fcc7a.js"><link rel="prefetch" href="/assets/js/93.0c4e5f88.js"><link rel="prefetch" href="/assets/js/94.c5725f80.js"><link rel="prefetch" href="/assets/js/95.dc61d501.js"><link rel="prefetch" href="/assets/js/96.3a598fc5.js"><link rel="prefetch" href="/assets/js/97.712aa8be.js"><link rel="prefetch" href="/assets/js/98.e757fe7a.js"><link rel="prefetch" href="/assets/js/99.1418024a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.35bcedcf.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">SUCKED BloG</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/other/index.html" class="nav-link">
  index
</a></div><div class="nav-item"><a href="/question/index.html" class="nav-link">
  question
</a></div><div class="nav-item"><a href="/audition/index.html" class="nav-link">
  audition
</a></div><div class="nav-item"><a href="/point/index.html" class="nav-link">
  point
</a></div><div class="nav-item"><a href="/work/index.html" class="nav-link">
  work
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="url" class="dropdown-title"><span class="title">url</span> <span class="arrow down"></span></button> <button type="button" aria-label="url" class="mobile-dropdown-title"><span class="title">url</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/other/config.html" class="nav-link">
  其他
</a></li><li class="dropdown-item"><!----> <a href="https://git.code.tencent.com/u/nampy" target="_blank" rel="noopener noreferrer" class="nav-link external">
  腾讯工蜂
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/willwxt" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="http://nbcb.icu" target="_blank" rel="noopener noreferrer" class="nav-link external">
  导航首页
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/other/index.html" class="nav-link">
  index
</a></div><div class="nav-item"><a href="/question/index.html" class="nav-link">
  question
</a></div><div class="nav-item"><a href="/audition/index.html" class="nav-link">
  audition
</a></div><div class="nav-item"><a href="/point/index.html" class="nav-link">
  point
</a></div><div class="nav-item"><a href="/work/index.html" class="nav-link">
  work
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="url" class="dropdown-title"><span class="title">url</span> <span class="arrow down"></span></button> <button type="button" aria-label="url" class="mobile-dropdown-title"><span class="title">url</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/other/config.html" class="nav-link">
  其他
</a></li><li class="dropdown-item"><!----> <a href="https://git.code.tencent.com/u/nampy" target="_blank" rel="noopener noreferrer" class="nav-link external">
  腾讯工蜂
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/willwxt" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="http://nbcb.icu" target="_blank" rel="noopener noreferrer" class="nav-link external">
  导航首页
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span></span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/question/mashibing/02-JavaContainer.html#什么是集合" class="sidebar-link">什么是集合</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/question/mashibing/02-JavaContainer.html#集合的特点" class="sidebar-link">集合的特点</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/question/mashibing/02-JavaContainer.html#集合和数组的区别" class="sidebar-link">集合和数组的区别</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/question/mashibing/02-JavaContainer.html#使用集合框架的好处" class="sidebar-link">使用集合框架的好处</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/question/mashibing/02-JavaContainer.html#常用的集合类有哪些" class="sidebar-link">常用的集合类有哪些？</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/question/mashibing/02-JavaContainer.html#list-set-map三者的区别-list、set、map-是否继-承自-collection-接口-list、map、set-三个接口存取-元素时-各有什么特点" class="sidebar-link">List，Set，Map三者的区别？List、Set、Map 是否继 承自 Collection 接口？List、Map、Set 三个接口存取 元素时，各有什么特点？</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/question/mashibing/02-JavaContainer.html#集合框架底层数据结构" class="sidebar-link">集合框架底层数据结构</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/question/mashibing/02-JavaContainer.html#哪些集合类是线程安全的" class="sidebar-link">哪些集合类是线程安全的？</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/question/mashibing/02-JavaContainer.html#java集合的快速失败机制-fail-fast" class="sidebar-link">Java集合的快速失败机制 “fail-fast”？</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/question/mashibing/02-JavaContainer.html#怎么确保一个集合不能被修改" class="sidebar-link">怎么确保一个集合不能被修改？</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/question/mashibing/02-JavaContainer.html#list接口" class="sidebar-link">List接口</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/question/mashibing/02-JavaContainer.html#迭代器-iterator-是什么" class="sidebar-link">迭代器 Iterator 是什么？</a></li><li class="sidebar-sub-header"><a href="/question/mashibing/02-JavaContainer.html#iterator-怎么使用-有什么特点" class="sidebar-link">Iterator 怎么使用？有什么特点？</a></li><li class="sidebar-sub-header"><a href="/question/mashibing/02-JavaContainer.html#如何边遍历边移除-collection-中的元素" class="sidebar-link">如何边遍历边移除 Collection 中的元素？</a></li><li class="sidebar-sub-header"><a href="/question/mashibing/02-JavaContainer.html#iterator-和-listiterator-有什么区别" class="sidebar-link">Iterator 和 ListIterator 有什么区别？</a></li><li class="sidebar-sub-header"><a href="/question/mashibing/02-JavaContainer.html#遍历一个-list-有哪些不同的方式-每种方法的实现原理是什-么-java-中-list-遍历的最佳实践是什么" class="sidebar-link">遍历一个 List 有哪些不同的方式？每种方法的实现原理是什 么？Java 中 List 遍历的最佳实践是什么？</a></li><li class="sidebar-sub-header"><a href="/question/mashibing/02-JavaContainer.html#遍历方式有以下几种" class="sidebar-link">遍历方式有以下几种：</a></li><li class="sidebar-sub-header"><a href="/question/mashibing/02-JavaContainer.html#说一下-arraylist-的优缺点" class="sidebar-link">说一下 ArrayList 的优缺点</a></li><li class="sidebar-sub-header"><a href="/question/mashibing/02-JavaContainer.html#如何实现数组和-list-之间的转换" class="sidebar-link">如何实现数组和 List 之间的转换？</a></li><li class="sidebar-sub-header"><a href="/question/mashibing/02-JavaContainer.html#arraylist-和-linkedlist-的区别是什么" class="sidebar-link">ArrayList 和 LinkedList 的区别是什么？</a></li><li class="sidebar-sub-header"><a href="/question/mashibing/02-JavaContainer.html#arraylist-和-vector-的区别是什么" class="sidebar-link">ArrayList 和 Vector 的区别是什么？</a></li><li class="sidebar-sub-header"><a href="/question/mashibing/02-JavaContainer.html#插入数据时-arraylist、linkedlist、vector谁速度较快-阐述-arraylist、vector、linkedlist-的存储性能和特性" class="sidebar-link">插入数据时，ArrayList、LinkedList、Vector谁速度较快？阐述 ArrayList、Vector、LinkedList 的存储性能和特性？</a></li><li class="sidebar-sub-header"><a href="/question/mashibing/02-JavaContainer.html#多线程场景下如何使用-arraylist" class="sidebar-link">多线程场景下如何使用 ArrayList？</a></li><li class="sidebar-sub-header"><a href="/question/mashibing/02-JavaContainer.html#为什么-arraylist-的-elementdata-加上-transient-修饰-arraylist-中的数组定义如下" class="sidebar-link">为什么 ArrayList 的 elementData 加上 transient 修饰？ ArrayList 中的数组定义如下：</a></li><li class="sidebar-sub-header"><a href="/question/mashibing/02-JavaContainer.html#list-和-set-的区别" class="sidebar-link">List 和 Set 的区别</a></li></ul></li><li><a href="/question/mashibing/02-JavaContainer.html#set接口" class="sidebar-link">Set接口</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/question/mashibing/02-JavaContainer.html#queue" class="sidebar-link">Queue</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/question/mashibing/02-JavaContainer.html#说一下-hashmap-的实现原理" class="sidebar-link">说一下 HashMap 的实现原理？</a></li><li class="sidebar-sub-header"><a href="/question/mashibing/02-JavaContainer.html#hashmap在jdk1-7和jdk1-8中有哪些不同-hashmap的底层实现" class="sidebar-link">HashMap在JDK1.7和JDK1.8中有哪些不同？ HashMap的底层实现</a></li><li class="sidebar-sub-header"><a href="/question/mashibing/02-JavaContainer.html#hashmap的put方法的具体流程" class="sidebar-link">HashMap的put方法的具体流程？</a></li><li class="sidebar-sub-header"><a href="/question/mashibing/02-JavaContainer.html#hashmap的扩容操作是怎么实现的" class="sidebar-link">HashMap的扩容操作是怎么实现的？</a></li><li class="sidebar-sub-header"><a href="/question/mashibing/02-JavaContainer.html#hashmap是怎么解决哈希冲突的" class="sidebar-link">HashMap是怎么解决哈希冲突的？</a></li><li class="sidebar-sub-header"><a href="/question/mashibing/02-JavaContainer.html#能否使用任何类作为-map-的-key" class="sidebar-link">能否使用任何类作为 Map 的 key？</a></li><li class="sidebar-sub-header"><a href="/question/mashibing/02-JavaContainer.html#为什么hashmap中string、integer这样的包装类适合作为key" class="sidebar-link">为什么HashMap中String、Integer这样的包装类适合作为Key？</a></li><li class="sidebar-sub-header"><a href="/question/mashibing/02-JavaContainer.html#如果使用object作为hashmap的key-应该怎么办呢" class="sidebar-link">如果使用Object作为HashMap的Key，应该怎么办呢？</a></li><li class="sidebar-sub-header"><a href="/question/mashibing/02-JavaContainer.html#hashmap为什么不直接使用hashcode-处理后的哈希值直接作为table的下标" class="sidebar-link">HashMap为什么不直接使用hashCode()处理后的哈希值直接作为table的下标？</a></li><li class="sidebar-sub-header"><a href="/question/mashibing/02-JavaContainer.html#hashmap-的长度为什么是2的幂次方" class="sidebar-link">HashMap 的长度为什么是2的幂次方</a></li><li class="sidebar-sub-header"><a href="/question/mashibing/02-JavaContainer.html#hashmap-与-hashtable-有什么区别" class="sidebar-link">HashMap 与 HashTable 有什么区别？</a></li><li class="sidebar-sub-header"><a href="/question/mashibing/02-JavaContainer.html#如何决定使用-hashmap-还是treemap" class="sidebar-link">如何决定使用 HashMap 还是TreeMap？</a></li><li class="sidebar-sub-header"><a href="/question/mashibing/02-JavaContainer.html#hashmap-和-concurrenthashmap-的区别" class="sidebar-link">HashMap 和 ConcurrentHashMap 的区别</a></li><li class="sidebar-sub-header"><a href="/question/mashibing/02-JavaContainer.html#concurrenthashmap-和-hashtable-的区别" class="sidebar-link">ConcurrentHashMap 和 Hashtable 的区别？</a></li><li class="sidebar-sub-header"><a href="/question/mashibing/02-JavaContainer.html#concurrenthashmap-底层具体实现知道吗-实现原理是什么" class="sidebar-link">ConcurrentHashMap 底层具体实现知道吗？实现原理是什么？</a></li></ul></li><li><a href="/question/mashibing/02-JavaContainer.html#辅助工具类" class="sidebar-link">辅助工具类</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/question/mashibing/02-JavaContainer.html#array-和-arraylist-有何区别" class="sidebar-link">Array 和 ArrayList 有何区别？</a></li><li class="sidebar-sub-header"><a href="/question/mashibing/02-JavaContainer.html#如何实现-array-和-list-之间的转换" class="sidebar-link">如何实现 Array 和 List 之间的转换？</a></li><li class="sidebar-sub-header"><a href="/question/mashibing/02-JavaContainer.html#comparable-和-comparator的区别" class="sidebar-link">comparable 和 comparator的区别？</a></li><li class="sidebar-sub-header"><a href="/question/mashibing/02-JavaContainer.html#collection-和-collections-有什么区别" class="sidebar-link">Collection 和 Collections 有什么区别？</a></li><li class="sidebar-sub-header"><a href="/question/mashibing/02-JavaContainer.html#treemap-和-treeset-在排序时如何比较元素-collections-工具类中的-sort-方法如何比较元素" class="sidebar-link">TreeMap 和 TreeSet 在排序时如何比较元素？ Collections 工具类中的 sort()方法如何比较元素？</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p>Java集合容器面试题(重点)</p> <h2 id="什么是集合"><a href="#什么是集合" class="header-anchor">#</a> 什么是集合</h2> <p><strong>集合框架</strong>：用于存储数据的容器。</p> <p>集合框架是为表示和操作集合而规定的一种统一的标准的体系结构。 任何集合框架都包含三大块内容：对外的接口, 接口的实现和对集合运算的算法。</p> <p><strong>接口</strong>：表示集合的抽象数据类型。接口允许我们操作集合时不必关注具体实现， 从而达到“多态”。在面向对象编程语言中，接口通常用来形成规范。</p> <p><strong>实现</strong>：集合接口的具体实现，是重用性很高的数据结构。</p> <p><strong>算法</strong>：在一个实现了某个集合框架中的接口的对象身上完成某种有用的计算的方法，例如查找、排序等。这些算法通常是多态的，因为相同的方法可以在同一个接口被多个类实现时有不同的表现。事实上，算法是可复用的函数。 它减少了程序设计的辛劳。</p> <p>集合框架通过提供有用的数据结构和算法使你能集中注意力于你的程序的重要部分上，而不是为了让程序能正常运转而将注意力于底层设计上。</p> <p>通过这些在无关API之间的简易的互用性, 使你免除了为改编对象或转换代码以便联合这些API而去写大量的代码。它提高了程序速度和质量。</p> <h2 id="集合的特点"><a href="#集合的特点" class="header-anchor">#</a> 集合的特点</h2> <p>集合的特点主要有如下两点：</p> <ul><li>对象封装数据，对象多了也需要存储。集合用于存储对象。</li> <li>对象的个数确定可以使用数组，对象的个数不确定的可以用集合。因为集合是可变长度的。</li></ul> <h2 id="集合和数组的区别"><a href="#集合和数组的区别" class="header-anchor">#</a> 集合和数组的区别</h2> <ul><li>数组是固定长度的；集合可变长度的。</li> <li>数组可以存储基本数据类型，也可以存储引用数据类型；集合只能存储引用数据类型。</li> <li>数组存储的元素必须是同一个数据类型；集合存储的对象可以是不同数据类型。</li></ul> <p><strong>数据结构</strong>：就是容器中存储数据的方式。</p> <p>对于集合容器，有很多种。因为每一个容器的自身特点不同，其实原理在于每个容器的内部数据结构不同。</p> <p>集合容器在不断向上抽取过程中，出现了集合体系。<strong>在使用一个体系的原则：参阅顶层内容。建立底层对象。</strong></p> <h2 id="使用集合框架的好处"><a href="#使用集合框架的好处" class="header-anchor">#</a> 使用集合框架的好处</h2> <ol><li>容量自增长</li> <li>提供了高性能的数据结构和算法，使编码更轻松，提高了程序速度和质量</li> <li>允许不同 API 之间的互操作，API之间可以来回传递集合</li> <li>可以方便地扩展或改写集合，提高代码复用性和可操作性</li> <li>通过使用JDK自带的集合类，可以降低代码维护和学习新API成本</li></ol> <h2 id="常用的集合类有哪些"><a href="#常用的集合类有哪些" class="header-anchor">#</a> 常用的集合类有哪些？</h2> <p>Map接口和Collection接口是所有集合框架的父接口：</p> <ol><li>Collection接口的子接口包括：Set List Queue</li> <li>Map接口的实现类主要有：HashMap、TreeMap、Hashtable、 ConcurrentHashMap以及Properties等</li> <li>Set接口的实现类主要有：HashSet、TreeSet、LinkedHashSet等</li> <li>List接口的实现类主要有：ArrayList、LinkedList、Stack以及Vector等</li></ol> <h2 id="list-set-map三者的区别-list、set、map-是否继-承自-collection-接口-list、map、set-三个接口存取-元素时-各有什么特点"><a href="#list-set-map三者的区别-list、set、map-是否继-承自-collection-接口-list、map、set-三个接口存取-元素时-各有什么特点" class="header-anchor">#</a> List，Set，Map三者的区别？List、Set、Map 是否继 承自 Collection 接口？List、Map、Set 三个接口存取 元素时，各有什么特点？</h2> <p><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="581px" height="431px" viewBox="-0.5 -0.5 581 431"><defs></defs><g><rect x="260" y="0" width="120" height="30" fill="#d5e8d4" stroke="#82b366" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow:visible;text-align:left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:flex;align-items:unsafe center;justify-content:unsafe center;width:118px;height:1px;padding-top:15px;margin-left:261px;"><div style="box-sizing:border-box;font-size:0;text-align:center;"><div style="display:inline-block;font-size:12px;font-family:Helvetica;color:#000000;line-height:1.2;pointer-events:all;white-space:normal;word-wrap:normal;">Collection</div></div></div></foreignObject><text x="320" y="19" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Collection</text></switch></g><path d="M 120 80 L 120 55 L 290 55 L 290 38.12" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 290 31.12 L 293.5 38.12 L 286.5 38.12 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all"></path><rect x="60" y="80" width="120" height="30" fill="#d5e8d4" stroke="#82b366" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow:visible;text-align:left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:flex;align-items:unsafe center;justify-content:unsafe center;width:118px;height:1px;padding-top:95px;margin-left:61px;"><div style="box-sizing:border-box;font-size:0;text-align:center;"><div style="display:inline-block;font-size:12px;font-family:Helvetica;color:#000000;line-height:1.2;pointer-events:all;white-space:normal;word-wrap:normal;">List<span style="color:rgba(0 , 0 , 0 , 0);font-family:monospace;font-size:0px;">%3CmxGraphModel%3E%3Croot%3E%3CmxCell%20id%3D%220%22%2F%3E%3CmxCell%20id%3D%221%22%20parent%3D%220%22%2F%3E%3CmxCell%20id%3D%222%22%20value%3D%22Collection%22%20style%3D%22rounded%3D0%3BwhiteSpace%3Dwrap%3Bhtml%3D1%3B%22%20vertex%3D%221%22%20parent%3D%221%22%3E%3CmxGeometry%20x%3D%22210%22%20y%3D%2240%22%20width%3D%22120%22%20height%3D%2230%22%20as%3D%22geometry%22%2F%3E%3C%2FmxCell%3E%3C%2Froot%3E%3C%2FmxGraphModel%3E</span></div></div></div></foreignObject><text x="120" y="99" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">List%3CmxGraphModel%...</text></switch></g><path d="M 340 80 L 340 55 L 320 55 L 320 38.12" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 320 31.12 L 323.5 38.12 L 316.5 38.12 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all"></path><rect x="280" y="80" width="120" height="30" fill="#d5e8d4" stroke="#82b366" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow:visible;text-align:left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:flex;align-items:unsafe center;justify-content:unsafe center;width:118px;height:1px;padding-top:95px;margin-left:281px;"><div style="box-sizing:border-box;font-size:0;text-align:center;"><div style="display:inline-block;font-size:12px;font-family:Helvetica;color:#000000;line-height:1.2;pointer-events:all;white-space:normal;word-wrap:normal;">Queue</div></div></div></foreignObject><text x="340" y="99" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Queue</text></switch></g><path d="M 520 80 L 520 55 L 350 55 L 350 38.12" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 350 31.12 L 353.5 38.12 L 346.5 38.12 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all"></path><rect x="460" y="80" width="120" height="30" fill="#d5e8d4" stroke="#82b366" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow:visible;text-align:left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:flex;align-items:unsafe center;justify-content:unsafe center;width:118px;height:1px;padding-top:95px;margin-left:461px;"><div style="box-sizing:border-box;font-size:0;text-align:center;"><div style="display:inline-block;font-size:12px;font-family:Helvetica;color:#000000;line-height:1.2;pointer-events:all;white-space:normal;word-wrap:normal;">Set</div></div></div></foreignObject><text x="520" y="99" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Set</text></switch></g><rect x="260" y="240" width="120" height="30" fill="#d5e8d4" stroke="#82b366" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow:visible;text-align:left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:flex;align-items:unsafe center;justify-content:unsafe center;width:118px;height:1px;padding-top:255px;margin-left:261px;"><div style="box-sizing:border-box;font-size:0;text-align:center;"><div style="display:inline-block;font-size:12px;font-family:Helvetica;color:#000000;line-height:1.2;pointer-events:all;white-space:normal;word-wrap:normal;">Map</div></div></div></foreignObject><text x="320" y="259" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Map</text></switch></g><path d="M 340 160 L 340 118.12" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 340 111.12 L 343.5 118.12 L 336.5 118.12 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all"></path><rect x="310" y="160" width="60" height="30" fill="#d5e8d4" stroke="#82b366" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow:visible;text-align:left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:flex;align-items:unsafe center;justify-content:unsafe center;width:58px;height:1px;padding-top:175px;margin-left:311px;"><div style="box-sizing:border-box;font-size:0;text-align:center;"><div style="display:inline-block;font-size:12px;font-family:Helvetica;color:#000000;line-height:1.2;pointer-events:all;white-space:normal;word-wrap:normal;">Deque</div></div></div></foreignObject><text x="340" y="179" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Deque</text></switch></g><path d="M 435 160 L 435 135 L 370 135 L 370 118.12" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 370 111.12 L 373.5 118.12 L 366.5 118.12 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all"></path><rect x="380" y="160" width="110" height="30" fill="#d5e8d4" stroke="#82b366" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow:visible;text-align:left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:flex;align-items:unsafe center;justify-content:unsafe center;width:108px;height:1px;padding-top:175px;margin-left:381px;"><div style="box-sizing:border-box;font-size:0;text-align:center;"><div style="display:inline-block;font-size:12px;font-family:Helvetica;color:#000000;line-height:1.2;pointer-events:all;white-space:normal;word-wrap:normal;">BlockingQueue</div></div></div></foreignObject><text x="435" y="179" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">BlockingQueue</text></switch></g><path d="M 52.5 160 L 52.5 135 L 90 135 L 90 118.12" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 90 111.12 L 93.5 118.12 L 86.5 118.12 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all"></path><rect x="0" y="160" width="70" height="30" fill="#dae8fc" stroke="#6c8ebf" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow:visible;text-align:left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:flex;align-items:unsafe center;justify-content:unsafe center;width:68px;height:1px;padding-top:175px;margin-left:1px;"><div style="box-sizing:border-box;font-size:0;text-align:center;"><div style="display:inline-block;font-size:12px;font-family:Helvetica;color:#000000;line-height:1.2;pointer-events:all;white-space:normal;word-wrap:normal;">Vector</div></div></div></foreignObject><text x="35" y="179" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Vector</text></switch></g><path d="M 120 160 L 120 118.12" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 120 111.12 L 123.5 118.12 L 116.5 118.12 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all"></path><rect x="80" y="160" width="80" height="30" fill="#dae8fc" stroke="#6c8ebf" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow:visible;text-align:left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:flex;align-items:unsafe center;justify-content:unsafe center;width:78px;height:1px;padding-top:175px;margin-left:81px;"><div style="box-sizing:border-box;font-size:0;text-align:center;"><div style="display:inline-block;font-size:12px;font-family:Helvetica;color:#000000;line-height:1.2;pointer-events:all;white-space:normal;word-wrap:normal;">ArrayList</div></div></div></foreignObject><text x="120" y="179" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">ArrayList</text></switch></g><path d="M 195 160 L 195 135 L 150 135 L 150 118.12" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 150 111.12 L 153.5 118.12 L 146.5 118.12 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all"></path><path d="M 245 160 L 245 135 L 310 135 L 310 118.12" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 310 111.12 L 313.5 118.12 L 306.5 118.12 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all"></path><rect x="170" y="160" width="100" height="30" fill="#dae8fc" stroke="#6c8ebf" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow:visible;text-align:left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:flex;align-items:unsafe center;justify-content:unsafe center;width:98px;height:1px;padding-top:175px;margin-left:171px;"><div style="box-sizing:border-box;font-size:0;text-align:center;"><div style="display:inline-block;font-size:12px;font-family:Helvetica;color:#000000;line-height:1.2;pointer-events:all;white-space:normal;word-wrap:normal;">LinkedList</div></div></div></foreignObject><text x="220" y="179" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">LinkedList</text></switch></g><path d="M 155 350 L 155 310 L 290 310 L 290 278.12" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 290 271.12 L 293.5 278.12 L 286.5 278.12 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all"></path><rect x="120" y="350" width="70" height="30" fill="#dae8fc" stroke="#6c8ebf" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow:visible;text-align:left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:flex;align-items:unsafe center;justify-content:unsafe center;width:68px;height:1px;padding-top:365px;margin-left:121px;"><div style="box-sizing:border-box;font-size:0;text-align:center;"><div style="display:inline-block;font-size:12px;font-family:Helvetica;color:#000000;line-height:1.2;pointer-events:all;white-space:normal;word-wrap:normal;">HashMap</div></div></div></foreignObject><text x="155" y="369" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">HashMap</text></switch></g><path d="M 240 350 L 240 310 L 290 310 L 290 278.12" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 290 271.12 L 293.5 278.12 L 286.5 278.12 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all"></path><rect x="200" y="350" width="80" height="30" fill="#dae8fc" stroke="#6c8ebf" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow:visible;text-align:left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:flex;align-items:unsafe center;justify-content:unsafe center;width:78px;height:1px;padding-top:365px;margin-left:201px;"><div style="box-sizing:border-box;font-size:0;text-align:center;"><div style="display:inline-block;font-size:12px;font-family:Helvetica;color:#000000;line-height:1.2;pointer-events:all;white-space:normal;word-wrap:normal;">HashTable</div></div></div></foreignObject><text x="240" y="369" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">HashTable</text></switch></g><path d="M 320 350 L 320 278.12" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 320 271.12 L 323.5 278.12 L 316.5 278.12 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all"></path><rect x="290" y="350" width="120" height="30" fill="#dae8fc" stroke="#6c8ebf" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow:visible;text-align:left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:flex;align-items:unsafe center;justify-content:unsafe center;width:118px;height:1px;padding-top:365px;margin-left:291px;"><div style="box-sizing:border-box;font-size:0;text-align:center;"><div style="display:inline-block;font-size:12px;font-family:Helvetica;color:#000000;line-height:1.2;pointer-events:all;white-space:normal;word-wrap:normal;">WeakHashMap</div></div></div></foreignObject><text x="350" y="369" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">WeakHashMap</text></switch></g><path d="M 170 400 L 155 400 L 155 388.12" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 155 381.12 L 158.5 388.12 L 151.5 388.12 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all"></path><rect x="120" y="400" width="100" height="30" fill="#dae8fc" stroke="#6c8ebf" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow:visible;text-align:left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:flex;align-items:unsafe center;justify-content:unsafe center;width:98px;height:1px;padding-top:415px;margin-left:121px;"><div style="box-sizing:border-box;font-size:0;text-align:center;"><div style="display:inline-block;font-size:12px;font-family:Helvetica;color:#000000;line-height:1.2;pointer-events:all;white-space:normal;word-wrap:normal;">LinkedHashMap</div></div></div></foreignObject><text x="170" y="419" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">LinkedHashMap</text></switch></g><path d="M 480 350 L 480 310 L 350 310 L 350 278.12" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 350 271.12 L 353.5 278.12 L 346.5 278.12 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all"></path><rect x="420" y="350" width="120" height="30" fill="#d5e8d4" stroke="#82b366" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow:visible;text-align:left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:flex;align-items:unsafe center;justify-content:unsafe center;width:118px;height:1px;padding-top:365px;margin-left:421px;"><div style="box-sizing:border-box;font-size:0;text-align:center;"><div style="display:inline-block;font-size:12px;font-family:Helvetica;color:#000000;line-height:1.2;pointer-events:all;white-space:normal;word-wrap:normal;">SortedMap</div></div></div></foreignObject><text x="480" y="369" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">SortedMap</text></switch></g><path d="M 480 400 L 480 388.12" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 480 381.12 L 483.5 388.12 L 476.5 388.12 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all"></path><rect x="420" y="400" width="120" height="30" fill="#dae8fc" stroke="#6c8ebf" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow:visible;text-align:left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:flex;align-items:unsafe center;justify-content:unsafe center;width:118px;height:1px;padding-top:415px;margin-left:421px;"><div style="box-sizing:border-box;font-size:0;text-align:center;"><div style="display:inline-block;font-size:12px;font-family:Helvetica;color:#000000;line-height:1.2;pointer-events:all;white-space:normal;word-wrap:normal;">TreeMap</div></div></div></foreignObject><text x="480" y="419" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">TreeMap</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"></g><a transform="translate(0,-5)" xlink:href="https://www.diagrams.net/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Viewer does not support full SVG 1.1</text></a></switch></svg></p> <p>Java 容器分为 Collection 和 Map 两大类，Collection集合的子接口有Set、 List、Queue三种子接口。常用的是Set和List; 而Map不是collection的子接口。</p> <p>Collection集合主要有List和Set两大接口</p> <ul><li>List：一个有序（元素存入集合的顺序和取出的顺序一致）容器，元素可以重 复，可以插入多个null元素，元素都有索引。常用的实现类有 ArrayList、LinkedList  和 Vector。</li> <li>Set：一个无序（存入和取出顺序有可能不一致）容器，不可以存储重复元素， 只允许存入一个null元素，必须保证元素唯一性。Set 接口常用实现类是 HashSet、 LinkedHashSet 以及 TreeSet。</li></ul> <p>Map是一个键值对集合，存储键、值和之间的映射。 Key无序，唯一；value 允许重复。从Map集合中检索元素时，只要给出键对象，就会返回对应的值对象。</p> <p>Map 的常用实现类：HashMap、TreeMap、HashTable、LinkedHashMap、 ConcurrentHashMap</p> <h2 id="集合框架底层数据结构"><a href="#集合框架底层数据结构" class="header-anchor">#</a> 集合框架底层数据结构</h2> <p><strong>List</strong></p> <ul><li>Arraylist / Vector： Object数组</li> <li>LinkedList： 双向循环链表</li></ul> <p><strong>Set</strong></p> <ul><li>HashSet（无序，唯一）：基于 HashMap 实现的</li> <li>LinkedHashSet： LinkedHashSet 继承与 HashSet，并且其内部是通过 LinkedHashMap 来实现的</li> <li>TreeSet（有序，唯一）： 红黑树</li> <li>HashMap： JDK1.8之前HashMap由数组+链表组成的，数组是HashMap的主 体，链表则是主要为了解决哈希冲突而存在的（“拉链法”解决冲突）.JDK1.8以后
在解决哈希冲突时有了较大的变化，当链表长度大于阈值（默认为8）时，将链表转 化为红黑树，以减少搜索时间</li> <li>LinkedHashMap：LinkedHashMap 继承自 HashMap，所以它的底层仍然是基于拉链式散列结构即由数组和链表或红黑树组成。另外，LinkedHashMap 在上面结构的基础上，增加了一条双向链表，使得上面的结构可以保持键值对的插入顺序。 同时通过对链表进行相应的操作，实现了访问顺序相关逻辑。</li> <li>HashTable： 数组+链表组成的，数组是 HashMap 的主体，链表则是主要为了解决哈希冲突而存在的</li> <li>TreeMap： 红黑树（自平衡的排序二叉树）</li></ul> <h2 id="哪些集合类是线程安全的"><a href="#哪些集合类是线程安全的" class="header-anchor">#</a> 哪些集合类是线程安全的？</h2> <ul><li>vector：就比arraylist多了个同步化机制（线程安全），因为效率较低，现在已经不太建议使用。在web应用中，特别是前台页面，往往效率（页面响应速度）是优先考虑的。</li> <li>statck：堆栈类，先进后出。</li> <li>hashtable：就比hashmap多了个线程安全。</li> <li>enumeration：枚举，相当于迭代器。</li></ul> <h2 id="java集合的快速失败机制-fail-fast"><a href="#java集合的快速失败机制-fail-fast" class="header-anchor">#</a> Java集合的快速失败机制 “fail-fast”？</h2> <p>是java集合的一种错误检测机制，当多个线程对集合进行结构上的改变的操作时，有可能会产生 fail-fast 机制。</p> <p>例如：假设存在两个线程（线程1、线程2），线程1通过Iterator在遍历集合A中 的元素，在某个时候线程2修改了集合A的结构（是结构上面的修改，而不是简单的修改集合元素的内容），那么这个时候程序就会抛出ConcurrentModificationException 异常，从而产生fail-fast机制。</p> <p>原因：迭代器在遍历时直接访问集合中的内容，并且在遍历过程中使用一个  modCount 变量。集合在被遍历期间如果内容发生变化，就会改变modCount 的值。每当迭代器使用hashNext()/next()遍历下一个元素之前，都会检测 modCount变量是否为expectedmodCount值，是的话就返回遍历；否则抛出异常，终止遍历。</p> <p>解决办法：</p> <ol><li>在遍历过程中，所有涉及到改变modCount值得地方全部加上 synchronized。</li> <li>使用CopyOnWriteArrayList来替换ArrayList</li></ol> <h2 id="怎么确保一个集合不能被修改"><a href="#怎么确保一个集合不能被修改" class="header-anchor">#</a> 怎么确保一个集合不能被修改？</h2> <p>可以使用 Collections.unmodifiableCollection(Collection c) 方法来创建一个只读集合，这样改变集合的任何操作都会抛出Java.lang.UnsupportedOperationException异常。 示例代码如下：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
 list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;x&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
 <span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> clist <span class="token operator">=</span> <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">unmodifiableCollection</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span> 
 clist<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;y&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 运行时此行报错 </span>
 <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>list<span class="token punctuation">.</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h1 id="collection接口"><a href="#collection接口" class="header-anchor">#</a> Collection接口</h1> <h2 id="list接口"><a href="#list接口" class="header-anchor">#</a> List接口</h2> <h3 id="迭代器-iterator-是什么"><a href="#迭代器-iterator-是什么" class="header-anchor">#</a> 迭代器 Iterator 是什么？</h3> <p>Iterator 接口提供遍历任何 Collection 的接口。我们可以从一个 Collection 中使用迭代器方法来获取迭代器实例。迭代器取代了 Java 集合框架中的 Enumeration，迭代器允许调用者在迭代过程中移除元素。</p> <h3 id="iterator-怎么使用-有什么特点"><a href="#iterator-怎么使用-有什么特点" class="header-anchor">#</a> Iterator 怎么使用？有什么特点？</h3> <p>Iterator 使用代码如下：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token class-name">Iterator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> it <span class="token operator">=</span> list<span class="token punctuation">.</span> terator
<span class="token keyword">while</span><span class="token punctuation">(</span>it<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">String</span> str <span class="token operator">=</span> it<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>Iterator 的特点是只能单向遍历，但是更加安全，因为它可以确保，在当前遍历</p> <p>的集合元素被更改的时候，就会抛出 ConcurrentModificationException 异常。</p> <h3 id="如何边遍历边移除-collection-中的元素"><a href="#如何边遍历边移除-collection-中的元素" class="header-anchor">#</a> 如何边遍历边移除 Collection 中的元素？</h3> <p>边遍历边修改 Collection 的唯一正确方式是使用 Iterator.remove() 方法，如下：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Iterator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> it <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">while</span><span class="token punctuation">(</span>it<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">// do something</span>
	it<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>一种  常见的错误代码如下：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> i <span class="token operator">:</span> list<span class="token punctuation">)</span><span class="token punctuation">{</span>
	list<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>运行以上错误代码会报 ConcurrentModificationException 异常。这是因为当使用 foreach(for(Integer i : list)) 语句时，会自动生成一个iterator来遍历该 list，但同时该 list 正在被 Iterator.remove() 修改。Java 一般不允许一个线程在遍历 Collection 时另一个线程修改它。</p> <h3 id="iterator-和-listiterator-有什么区别"><a href="#iterator-和-listiterator-有什么区别" class="header-anchor">#</a> Iterator 和 ListIterator 有什么区别？</h3> <ul><li>Iterator 可以遍历 Set 和 List 集合，而 ListIterator 只能遍历 List。</li> <li>Iterator 只能单向遍历，而 ListIterator 可以双向遍历（向前/后遍历）。</li> <li>ListIterator 实现 Iterator 接口，然后添加了一些额外的功能，比如添加一个元素、替换一个元素、获取前面或后面元素的索引位置。</li></ul> <h3 id="遍历一个-list-有哪些不同的方式-每种方法的实现原理是什-么-java-中-list-遍历的最佳实践是什么"><a href="#遍历一个-list-有哪些不同的方式-每种方法的实现原理是什-么-java-中-list-遍历的最佳实践是什么" class="header-anchor">#</a> 遍历一个 List 有哪些不同的方式？每种方法的实现原理是什 么？Java 中 List 遍历的最佳实践是什么？</h3> <h3 id="遍历方式有以下几种"><a href="#遍历方式有以下几种" class="header-anchor">#</a> 遍历方式有以下几种：</h3> <ol><li><p>for 循环遍历，基于计数器。在集合外部维护一个计数器，然后依次读取每一个位置的元素，当读取到后一个元素后停止。</p></li> <li><p>迭代器遍历，Iterator。Iterator 是面向对象的一个设计模式，目的是屏蔽不同数据集合的特点，统一遍历集合的接口。Java 在 Collections 中支持了 Iterator 模式。</p></li> <li><p>foreach 循环遍历。foreach 内部也是采用了 Iterator 的方式实现，使用时不需要显式声明 Iterator 或计数器。优点是代码简洁，不易出错；缺点是只能做简单的遍历，比如不能在遍历过程中操作删除数据集合</p></li></ol> <p>最佳实践：Java Collections 框架中提供了一个 RandomAccess 接口，用来标记 List 实现是否支持Random Access。</p> <ul><li>如果一个数据集合实现了该接口，就意味着它支持 Random Access，按位置读取元素的平均时间复杂度为 O(1)，如ArrayList。</li> <li>如果没有实现该接口，表示不支持 Random Access，如LinkedList。</li> <li>推荐的做法就是，支持 Random Access 的列表可用 for 循环遍历，否则建议用 Iterator 或 foreach。</li></ul> <h3 id="说一下-arraylist-的优缺点"><a href="#说一下-arraylist-的优缺点" class="header-anchor">#</a> 说一下 ArrayList 的优缺点</h3> <p>ArrayList的优点如下：</p> <ul><li>ArrayList 底层以数组实现，是一种随机访问模式。ArrayList 实现了 RandomAccess 接口，因此查找的时候非常快。</li> <li>ArrayList 在顺序添加一个元素的时候非常方便。</li></ul> <p>ArrayList 的缺点如下：</p> <ul><li>删除元素的时候，需要做一次元素复制操作。如果要复制的元素很多，那么就会比较耗费性能。</li> <li>插入元素的时候，也需要做一次元素复制操作，缺点同上。</li></ul> <p>ArrayList 比较适合顺序添加、随机访问的场景。</p> <h3 id="如何实现数组和-list-之间的转换"><a href="#如何实现数组和-list-之间的转换" class="header-anchor">#</a> 如何实现数组和 List 之间的转换？</h3> <p>数组转 List：使用 Arrays. asList(array) 进行转换。</p> <p>List 转数组：使用 List 自带的 toArray() 方法。代码示例：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// list to array</span>
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;123&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;456&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
list<span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// array to list</span>
<span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> array <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token string">&quot;123&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;456&quot;</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span>array<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="arraylist-和-linkedlist-的区别是什么"><a href="#arraylist-和-linkedlist-的区别是什么" class="header-anchor">#</a> ArrayList 和 LinkedList 的区别是什么？</h3> <ul><li>数据结构实现：ArrayList 是动态数组的数据结构实现，而 LinkedList 是双向链表的数据结构实现。</li> <li>随机访问效率：ArrayList 比 LinkedList 在随机访问的时候效率要高，因为 LinkedList 是线性的数据存储方式，所以需要移动指针从前往后依次查找。</li> <li>增加和删除效率：在非首尾的增加和删除操作，LinkedList 要比 ArrayList 效率要高，因为 ArrayList 增删操作要影响数组内的其他数据的下标。</li> <li>内存空间占用：LinkedList 比 ArrayList 更占内存，因为 LinkedList 的节点除了存储数据，还存储了两个引用，一个指向前一个元素，一个指向后一个元素。</li> <li>线程安全：ArrayList 和 LinkedList 都是不同步的，也就是不保证线程安全；</li></ul> <p>综合来说，在需要频繁读取集合中的元素时，更推荐使用 ArrayList，而在插入和删除操作较多时，更推荐使用 LinkedList。</p> <p>补充：数据结构基础之双向链表</p> <p>双向链表也叫双链表，是链表的一种，它的每个数据结点中都有两个指针，分别指向直接后继和直接前驱。所以，从双向链表中的任意一个结点开始，都可以很方便地访问它的前驱结点和后继结点。</p> <h3 id="arraylist-和-vector-的区别是什么"><a href="#arraylist-和-vector-的区别是什么" class="header-anchor">#</a> ArrayList 和 Vector 的区别是什么？</h3> <p>这两个类都实现了 List 接口（List 接口继承了 Collection 接口），他们都是有序集合</p> <p>线程安全：Vector 使用了 Synchronized 来实现线程同步，是线程安全的，而 ArrayList 是非线程安全的。</p> <p>性能：ArrayList 在性能方面要优于 Vector。</p> <p>扩容：ArrayList 和 Vector 都会根据实际的需要动态的调整容量，只不过在 Vector 扩容每次会增加 1 倍，而 ArrayList 只会增加 50%。</p> <p>Vector类的所有方法都是同步的。可以由两个线程安全地访问一个Vector对象、但是一个线程访问Vector的话代码要在同步操作上耗费大量的时间。</p> <p>Arraylist不是同步的，所以在不需要保证线程安全时时建议使用Arraylist。</p> <h3 id="插入数据时-arraylist、linkedlist、vector谁速度较快-阐述-arraylist、vector、linkedlist-的存储性能和特性"><a href="#插入数据时-arraylist、linkedlist、vector谁速度较快-阐述-arraylist、vector、linkedlist-的存储性能和特性" class="header-anchor">#</a> 插入数据时，ArrayList、LinkedList、Vector谁速度较快？阐述 ArrayList、Vector、LinkedList 的存储性能和特性？</h3> <p>ArrayList、LinkedList、Vector 底层的实现都是使用数组方式存储数据。数组元素数大于实际存储的数据以便增加和插入元素，它们都允许直接按序号索引元素，但是插入元素要涉及数组元素移动等内存操作，所以索引数据快而插入数据慢。</p> <p>Vector 中的方法由于加了 synchronized 修饰，因此 Vector是线程安全容器，但性能上较ArrayList差。</p> <p>LinkedList 使用双向链表实现存储，按序号索引数据需要进行前向或后向遍历，但插入数据时只需要记录当前项的前后项即可，所以 LinkedList插入速度较快。</p> <h3 id="多线程场景下如何使用-arraylist"><a href="#多线程场景下如何使用-arraylist" class="header-anchor">#</a> 多线程场景下如何使用 ArrayList？</h3> <p>ArrayList 不是线程安全的，如果遇到多线程场景，可以通过 Collections 的 synchronizedList 方法将其转换成线程安全的容器后再使用。例如像下面这样：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> synchronizedList <span class="token operator">=</span> <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">synchronizedList</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>
synchronizedList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;aaa&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
synchronizedList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;bbb&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> synchronizedList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>synchronizedList<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="为什么-arraylist-的-elementdata-加上-transient-修饰-arraylist-中的数组定义如下"><a href="#为什么-arraylist-的-elementdata-加上-transient-修饰-arraylist-中的数组定义如下" class="header-anchor">#</a> 为什么 ArrayList 的 elementData 加上 transient 修饰？ ArrayList 中的数组定义如下：</h3> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token number">1</span> <span class="token keyword">private</span> <span class="token keyword">transient</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> elementData<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>再看一下 ArrayList 的定义：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token number">1</span>	<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">extends</span> <span class="token class-name">AbstractList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">&gt;</span></span>
<span class="token number">2</span>	<span class="token keyword">implements</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">,</span> <span class="token class-name">RandomAccess</span><span class="token punctuation">,</span> <span class="token class-name">Cloneable</span><span class="token punctuation">,</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span>Serializable</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>可以看到 ArrayList 实现了 Serializable 接口，这意味着 ArrayList 支持序列</p> <p>化。transient 的作用是说不希望 elementData 数组被序列化，重写了 writeObject 实现：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">writeObject</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span>ObjectOutputStream</span> s<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">{</span> 
    <span class="token comment">// Write out element count, and any hidden stuff</span>
    <span class="token keyword">int</span> expectedModCount <span class="token operator">=</span> modCount<span class="token punctuation">;</span> 
    s<span class="token punctuation">.</span><span class="token function">defaultWriteObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token comment">// Write out array length</span>
    s<span class="token punctuation">.</span><span class="token function">writeInt</span><span class="token punctuation">(</span>elementData<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token comment">// Write out all elements in the proper order.</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> 
    	s<span class="token punctuation">.</span><span class="token function">writeObject</span><span class="token punctuation">(</span>elementData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token keyword">if</span> <span class="token punctuation">(</span>modCount <span class="token operator">!=</span> expectedModCount<span class="token punctuation">)</span>
    	<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ConcurrentModificationException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>每次序列化时，先调用 defaultWriteObject() 方法序列化 ArrayList 中的非transient 元素，然后遍历 elementData，只序列化已存入的元素，这样既加快了序列化的速度，又减小了序列化之后的文件大小。</p> <h3 id="list-和-set-的区别"><a href="#list-和-set-的区别" class="header-anchor">#</a> List 和 Set 的区别</h3> <p>List , Set 都是继承自Collection 接口</p> <p>List 特点：一个有序（元素存入集合的顺序和取出的顺序一致）容器，元素可以重复，可以插入多个null元素，元素都有索引。常用的实现类有 ArrayList, LinkedList 和 Vector。</p> <p>Set 特点：一个无序（存入和取出顺序有可能不一致）容器，不可以存储重复元素，只允许存入一个null元素，必须保证元素唯一性。Set 接口常用实现类是 HashSet、LinkedHashSet 以及 TreeSet。</p> <p>另外 List 支持for循环，也就是通过下标来遍历，也可以用迭代器，但是set只能用迭代，因为他无序，无法用下标来取得想要的值。</p> <p>Set和List对比</p> <p>Set：检索元素效率低下，删除和插入效率高，插入和删除不会引起元素位置改变。</p> <p>List：和数组类似，List可以动态增长，查找元素效率高，插入删除元素效率低，因为会引起其他元素位置改变</p> <h2 id="set接口"><a href="#set接口" class="header-anchor">#</a> Set接口</h2> <h4 id="说一下-hashset-的实现原理"><a href="#说一下-hashset-的实现原理" class="header-anchor">#</a> 说一下 HashSet 的实现原理？</h4> <p>HashSet 是基于 HashMap 实现的，HashSet的值存放于HashMap的key上，</p> <p>HashMap的value统一为PRESENT，因此 HashSet 的实现比较简单，相关 HashSet 的操作，基本上都是直接调用底层 HashMap 的相关方法来完成，HashSet 不允许重复的值。</p> <h4 id="hashset如何检查重复-hashset是如何保证数据不可重复的"><a href="#hashset如何检查重复-hashset是如何保证数据不可重复的" class="header-anchor">#</a> HashSet如何检查重复？HashSet是如何保证数据不可重复的？</h4> <p>向HashSet 中add ()元素时，判断元素是否存在的依据，不仅要比较hash值，同时还要结合equles 方法比较。</p> <p>HashSet 中的add ()方法会使用HashMap 的put()方法。</p> <p>HashMap 的 key 是唯一的，由源码可以看出 HashSet 添加进去的值就是作为 HashMap 的key，并且在HashMap中如果K/V相同时，会用新的V覆盖掉旧的V，然后返回旧的V。所以不会重复（ HashMap 比较key是否相等是先比较 hashcode 再比较equals ）。</p> <p>以下是HashSet 部分源码：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Object</span> PRESENT <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">private</span> <span class="token keyword">transient</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">,</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> map<span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token class-name">HashSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
	map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">E</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// 调用HashMap的put方法,PRESENT是一个至始至终都相同的虚值</span>
	<span class="token keyword">return</span> map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> PRESENT<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>hashCode() 与 equals() 的相关规定：</p> <ol><li><p>如果两个对象相等，则hashcode一定也是相同的</p></li> <li><p>两个对象相等, 对两个equals方法返回true</p></li> <li><p>两个对象有相同的hashcode值, 它们也不一定是相等的</p></li> <li><p>综上, equals方法被覆盖过, 则hashCode方法也必须被覆盖</p></li> <li><p>hashCode()的默认行为是对堆上的对象产生独特值。如果没有重写hashCode()，则该class的两个对象无论如何都不会相等（即使这两个对象指向相同的数据）。</p></li></ol> <p>== 与 equals 的区别</p> <ol><li>==是判断两个变量或实例是不是指向同一个内存空间 equals是判断两个变量或实例所指向的内存空间的值是不是相同</li> <li>==是指对内存地址进行比较 equals()是对字符串的内容进行比较</li> <li>== 指引用是否相同 equals()指的是值是否相同</li></ol> <h4 id="hashset与hashmap的区别"><a href="#hashset与hashmap的区别" class="header-anchor">#</a> HashSet与HashMap的区别</h4> <table><thead><tr><th>HashMap</th> <th>HashSet</th></tr></thead> <tbody><tr><td>实现了Map接口</td> <td>实现了Set接口</td></tr> <tr><td>存储键值对</td> <td>仅存储对象</td></tr> <tr><td>调用 put 添加元素</td> <td>调用 add 添加元素</td></tr> <tr><td>HashMap使用键(key)计算hashcode</td> <td>使用添加的对象计算hashcode</td></tr></tbody></table> <h2 id="queue"><a href="#queue" class="header-anchor">#</a> Queue</h2> <h4 id="blockingqueue是什么"><a href="#blockingqueue是什么" class="header-anchor">#</a> BlockingQueue是什么？</h4> <p>java.util.concurrent.BlockingQueue是一个队列，在进行检索或移除一个元素的时候，它会等待队列变为非空；当在添加一个元素时，它会等待队列中的可用空间。BlockingQueue接口是Java集合框架的一部分，主要用于实现生产者-消费者模式。我们不需要担心等待生产者有可用的空间，或消费者有可用的对象，因为它都在BlockingQueue的实现类中被处理了。Java提供了集中 BlockingQueue的实现，比如ArrayBlockingQueue、LinkedBlockingQueue、PriorityBlockingQueue,、SynchronousQueue等。</p> <h4 id="在-queue-中-poll-和-remove-有什么区别"><a href="#在-queue-中-poll-和-remove-有什么区别" class="header-anchor">#</a> 在 Queue 中 poll()和 remove()有什么区别？</h4> <ul><li>相同点：都是返回第一个元素，并在队列中删除返回的对象。</li> <li>不同点：如果没有元素 poll()会返回 null，而 remove()会直接抛出 NoSuchElementException 异常。</li></ul> <p>代码示例：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Queue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> queue <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
queue<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span><span class="token string">&quot;string&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// add</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>queue<span class="token punctuation">.</span><span class="token function">poll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>queue<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>queue<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h1 id="map接口"><a href="#map接口" class="header-anchor">#</a> Map接口</h1> <h3 id="说一下-hashmap-的实现原理"><a href="#说一下-hashmap-的实现原理" class="header-anchor">#</a> 说一下 HashMap 的实现原理？</h3> <p>HashMap概述： HashMap是基于哈希表的Map接口的非同步实现。此实现提供所有可选的映射操作，并允许使用null值和null键。此类不保证映射的顺序，特别是它不保证该顺序恒久不变。</p> <p>HashMap的数据结构： 在Java编程语言中， 基本的结构就是两种，一个是数组，另外一个是模拟指针（引用），所有的数据结构都可以用这两个基本结构来构造的，HashMap也不例外。HashMap实际上是一个“链表散列”的数据结构，即数组和链表的结合体。</p> <p>HashMap 基于 Hash 算法实现的</p> <ol><li><p>当我们往Hashmap中put元素时，利用key的hashCode重新hash计算出当前对象的元素在数组中的下标</p></li> <li><p>存储时，如果出现hash值相同的key，此时有两种情况。</p> <p>(1) 如果key相同，则覆盖原始值；</p> <p>(2) 如果key不同（出现冲突），则将当前的key-value 放入链表中</p></li> <li><p>获取时，直接找到hash值对应的下标，在进一步判断key是否相同，从而找到对应值。</p></li> <li><p>理解了以上过程就不难明白HashMap是如何解决hash冲突的问题，核心就是使用了数组的存储方式，然后将冲突的key的对象放入链表中，一旦发现冲突就在链表中做进一步的对比。</p></li></ol> <p>需要注意Jdk 1.8中对HashMap的实现做了优化，当链表中的节点数 &gt; 8之后，该链表会转为红黑树来提高查询效率，从原来的O(n)到O(logn)</p> <h3 id="hashmap在jdk1-7和jdk1-8中有哪些不同-hashmap的底层实现"><a href="#hashmap在jdk1-7和jdk1-8中有哪些不同-hashmap的底层实现" class="header-anchor">#</a> HashMap在JDK1.7和JDK1.8中有哪些不同？ HashMap的底层实现</h3> <p>在Java中，保存数据有两种比较简单的数据结构：数组和链表。数组的特点是：寻址容易，插入和删除困难；链表的特点是：寻址困难，但插入和删除容易；所以我们将数组和链表结合在一起，发挥两者各自的优势，使用一种叫做拉链法的方式可以解决哈希冲突。</p> <h4 id="jdk1-8之前"><a href="#jdk1-8之前" class="header-anchor">#</a> JDK1.8之前</h4> <p>JDK1.8之前采用的是拉链法。拉链法：将链表和数组相结合。也就是说创建一个链表数组，数组中每一格就是一个链表。若遇到哈希冲突，则将冲突的值加到链表中即可。</p> <h4 id="jdk1-8之后"><a href="#jdk1-8之后" class="header-anchor">#</a> JDK1.8之后</h4> <p>相比于之前的版本，jdk1.8在解决哈希冲突时有了较大的变化，当链表长度大于阈值（默认为8）时，将链表转化为红黑树，以减少搜索时间。</p> <h4 id="jdk1-7-vs-jdk1-8-比较"><a href="#jdk1-7-vs-jdk1-8-比较" class="header-anchor">#</a> JDK1.7 VS JDK1.8 比较</h4> <p>JDK1.8主要解决或优化了一下问题：</p> <ol><li><p>resize 扩容优化</p></li> <li><p>引入了红黑树，目的是避免单条链表过长而影响查询效率，红黑树算法请参考</p></li> <li><p>解决了多线程死循环问题，但仍是非线程安全的，多线程时可能会造成数据丢失问题。</p></li></ol> <table><thead><tr><th>不同</th> <th>JDK 1.7</th> <th>JDK 1.8</th></tr></thead> <tbody><tr><td>存储结构</td> <td>数组 + 链表</td> <td>数组 + 链表 + 红黑树</td></tr> <tr><td>初始化方式</td> <td>单独函数：inflateTable()</td> <td>直接集成到了扩容函数  resize()中</td></tr> <tr><td>hash值计算方式</td> <td>扰动处理 = 9次扰动 = 4次位运算 + 5次异或运算</td> <td>扰动处理 = 2次扰动 = 1次位运算 + 1次异或运算</td></tr> <tr><td>存放数据 的规则</td> <td>无冲突时，存放数组；冲突时，存放链表</td> <td>无冲突时，存放数组；冲突 &amp; 链表长度 &lt; 8：存放单链表；冲突 &amp; 链表长度 &gt; 8：树化并存放红黑树</td></tr> <tr><td>插入数据 方式</td> <td>头插法: 先将原位置的数据移到后1 位，再插入数据到该位置</td> <td>尾插法: 直接插入到链表尾部</td></tr> <tr><td>扩容后存 储位置的 计算方式</td> <td>全部按照原来方法进行计算:  hashCode--扰动函数--(h&amp;length-1)</td> <td>按照扩容后的规律计算:  扩容后的位置 = 原位置 or 原位置 + 旧容量</td></tr></tbody></table> <h3 id="hashmap的put方法的具体流程"><a href="#hashmap的put方法的具体流程" class="header-anchor">#</a> HashMap的put方法的具体流程？</h3> <p>当我们put的时候，首先计算 key的hash值，这里调用了 hash方法，hash方法实际是让key.hashCode()与key.hashCode()&gt;&gt;&gt;16进行异或操作，高16bit补0，一个数和0异或不变，所以 hash 函数大概的作用就是：高16bit不变，低16bit和高16bit做了一个异或，目的是减少碰撞。</p> <p>按照函数注释，因为bucket数组大小是2的幂，计算下标index = (table.length - 1) &amp; hash，如果不做 hash 处理，相当于散列生效的只有几个低 bit 位，为了减少散列的碰撞，设计者综合考虑了速度、作用、质量之后，使用高16bit和低16bit异或来简单处理减少碰撞，而且JDK8中用了红黑树结构来提升碰撞下的性能。</p> <p>putVal方法执行流程图</p> <p><svg id="SvgjsSvg1006" width="988.7073974609375" height="867.2982940673828" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.com/svgjs"><defs id="SvgjsDefs1007"><marker id="SvgjsMarker1024" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1025" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1028" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1029" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1042" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1043" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1058" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1059" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1072" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1073" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1118" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1119" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1130" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1131" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1144" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1145" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1164" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1165" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1168" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1169" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1185" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1186" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1189" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1190" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1193" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1194" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1201" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1202" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1217" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1218" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1221" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1222" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1237" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1238" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1251" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1252" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1255" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1256" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1269" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1270" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1277" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1278" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1281" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1282" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1285" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1286" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1289" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1290" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1293" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1294" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker></defs><g id="SvgjsG1008" transform="translate(36.38373870283532,103.79735056559244)"><path id="SvgjsPath1009" d="M 0 4Q 0 0 4 0L 107.64511293066637 0Q 111.64511293066637 0 111.64511293066637 4L 111.64511293066637 37.486111111111114Q 111.64511293066637 41.486111111111114 107.64511293066637 41.486111111111114L 4 41.486111111111114Q 0 41.486111111111114 0 37.486111111111114Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffcccc"></path><g id="SvgjsG1010"><text id="SvgjsText1011" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="92px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="11.293055555555558" transform="rotate(0)"><tspan id="SvgjsTspan1012" dy="16" x="56"><tspan id="SvgjsTspan1013">开始</tspan></tspan></text></g></g><g id="SvgjsG1014" transform="translate(25.009525636367506,180.6660435994466)"><path id="SvgjsPath1015" d="M 0 31.253153483072936L 66.05934822515422 0L 132.11869645030845 31.253153483072936L 66.05934822515422 62.50630696614587Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#99ffcc"></path><g id="SvgjsG1016"><text id="SvgjsText1017" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="113px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="14.115685017903665" transform="rotate(0)"><tspan id="SvgjsTspan1018" dy="16" x="66.5"><tspan id="SvgjsTspan1019">table</tspan></tspan><tspan id="SvgjsTspan1020" dy="16" x="66.5"><tspan id="SvgjsTspan1021">是否为空</tspan></tspan></text></g></g><g id="SvgjsG1022"><path id="SvgjsPath1023" d="M92.20629516816851 145.28346167670355L92.20629516816851 162.97475263807507L91.06887386152174 162.97475263807507L91.06887386152174 180.6660435994466" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1024)"></path></g><g id="SvgjsG1026"><path id="SvgjsPath1027" d="M157.1282220866761 211.91919708251953L197.5129376397682 211.91919708251953L197.5129376397682 211.52459173634227L237.89765319286033 211.52459173634227" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1028)"></path><rect id="SvgjsRect1030" width="13" height="15" x="191.0129376397682" y="204.2218944094309" fill="#ffffff"></rect><text id="SvgjsText1031" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="13px" fill="#323232" font-weight="400" align="top" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="202.2718944094309" transform="rotate(0)"><tspan id="SvgjsTspan1032" dy="16" x="197.5129376397682"><tspan id="SvgjsTspan1033">是</tspan></tspan></text></g><g id="SvgjsG1034" transform="translate(237.89765319286033,176.52459173634227)"><path id="SvgjsPath1035" d="M 0 4Q 0 0 4 0L 96 0Q 100 0 100 4L 100 66Q 100 70 96 70L 4 70Q 0 70 0 66Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ccffff"></path><g id="SvgjsG1036"><text id="SvgjsText1037" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="80px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="25.55" transform="rotate(0)"><tspan id="SvgjsTspan1038" dy="16" x="50"><tspan id="SvgjsTspan1039">resize()</tspan></tspan></text></g></g><g id="SvgjsG1040"><path id="SvgjsPath1041" d="M91.06887386152174 243.17235056559258L91.06887386152174 263.8390172322593L92.17886032591885 263.8390172322593L92.17886032591885 284.50568389892607" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1042)"></path><rect id="SvgjsRect1044" width="13" height="15" x="85.12386709372029" y="256.3390172322593" fill="#ffffff"></rect><text id="SvgjsText1045" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="13px" fill="#323232" font-weight="400" align="top" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="254.38901723225933" transform="rotate(0)"><tspan id="SvgjsTspan1046" dy="16" x="91.62386709372029"><tspan id="SvgjsTspan1047">否</tspan></tspan></text></g><g id="SvgjsG1048" transform="translate(42.17886032591885,284.50568389892607)"><path id="SvgjsPath1049" d="M 0 4Q 0 0 4 0L 96 0Q 100 0 100 4L 100 66Q 100 70 96 70L 4 70Q 0 70 0 66Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffff99"></path><g id="SvgjsG1050"><text id="SvgjsText1051" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="80px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="17.55" transform="rotate(0)"><tspan id="SvgjsTspan1052" dy="16" x="50"><tspan id="SvgjsTspan1053">根据key</tspan></tspan><tspan id="SvgjsTspan1054" dy="16" x="50"><tspan id="SvgjsTspan1055">计算索引</tspan></tspan></text></g></g><g id="SvgjsG1056"><path id="SvgjsPath1057" d="M152.20629516816854 434.77552516876716L181.38329616975807 434.77552516876716L181.38329616975807 433.7390123846109L210.56029717134763 433.7390123846109" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1058)"></path><rect id="SvgjsRect1060" width="13" height="15" x="174.88329616975807" y="426.757268776689" fill="#ffffff"></rect><text id="SvgjsText1061" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="13px" fill="#323232" font-weight="400" align="top" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="424.807268776689" transform="rotate(0)"><tspan id="SvgjsTspan1062" dy="16" x="181.38329616975807"><tspan id="SvgjsTspan1063">否</tspan></tspan></text></g><g id="SvgjsG1064" transform="translate(210.56029717134763,399.08879146318037)"><path id="SvgjsPath1065" d="M 0 34.6502209214307L 67.27507716049399 0L 134.55015432098799 34.6502209214307L 67.27507716049399 69.3004418428614Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#99ffcc"></path><g id="SvgjsG1066"><text id="SvgjsText1067" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="115px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="25.54672313064501" transform="rotate(0)"><tspan id="SvgjsTspan1068" dy="16" x="67.5"><tspan id="SvgjsTspan1069">key是否存在</tspan></tspan></text></g></g><g id="SvgjsG1070"><path id="SvgjsPath1071" d="M345.1104514923358 433.7390123846109L374.8207066964818 433.7390123846109L374.8207066964818 213.96336736300063L404.53096190062774 213.96336736300063" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1072)"></path><rect id="SvgjsRect1074" width="13" height="15" x="368.3207066964818" y="316.35118987380577" fill="#ffffff"></rect><text id="SvgjsText1075" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="13px" fill="#323232" font-weight="400" align="top" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="314.4011898738058" transform="rotate(0)"><tspan id="SvgjsTspan1076" dy="16" x="374.8207066964818"><tspan id="SvgjsTspan1077">否</tspan></tspan></text></g><g id="SvgjsG1078" transform="translate(404.53096190062774,176.7279061211481)"><path id="SvgjsPath1079" d="M 0 37.23546124185248L 67.51362930278916 0L 135.0272586055783 37.23546124185248L 67.51362930278916 74.47092248370495Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#99ffcc"></path><g id="SvgjsG1080"><text id="SvgjsText1081" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="116px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="20.157815854271004" transform="rotate(0)"><tspan id="SvgjsTspan1082" dy="16" x="68"><tspan id="SvgjsTspan1083">table[i]</tspan></tspan><tspan id="SvgjsTspan1084" dy="16" x="68"><tspan id="SvgjsTspan1085">是红黑树?</tspan></tspan></text></g></g><g id="SvgjsG1086" transform="translate(421.23444821304577,285.2596521528944)"><path id="SvgjsPath1087" d="M 0 4Q 0 0 4 0L 98 0Q 102 0 102 4L 102 66Q 102 70 98 70L 4 70Q 0 70 0 66Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffff99"></path><g id="SvgjsG1088"><text id="SvgjsText1089" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="82px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="17.55" transform="rotate(0)"><tspan id="SvgjsTspan1090" dy="16" x="51"><tspan id="SvgjsTspan1091">开始遍历链表</tspan></tspan><tspan id="SvgjsTspan1092" dy="16" x="51"><tspan id="SvgjsTspan1093">准备插入</tspan></tspan></text></g></g><g id="SvgjsG1094" transform="translate(228.80633436080066,534.7530547265438)"><path id="SvgjsPath1095" d="M 0 4Q 0 0 4 0L 96 0Q 100 0 100 4L 100 66Q 100 70 96 70L 4 70Q 0 70 0 66Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffff99"></path><g id="SvgjsG1096"><text id="SvgjsText1097" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="80px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="17.55" transform="rotate(0)"><tspan id="SvgjsTspan1098" dy="16" x="50"><tspan id="SvgjsTspan1099">直接覆盖</tspan></tspan><tspan id="SvgjsTspan1100" dy="16" x="50"><tspan id="SvgjsTspan1101">value</tspan></tspan></text></g></g><g id="SvgjsG1102" transform="translate(863.7212863498272,177.85917824340072)"><path id="SvgjsPath1103" d="M 0 4Q 0 0 4 0L 96 0Q 100 0 100 4L 100 66Q 100 70 96 70L 4 70Q 0 70 0 66Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffff99"></path><g id="SvgjsG1104"><text id="SvgjsText1105" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="80px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="17.55" transform="rotate(0)"><tspan id="SvgjsTspan1106" dy="16" x="50"><tspan id="SvgjsTspan1107">在红黑树中</tspan></tspan><tspan id="SvgjsTspan1108" dy="16" x="50"><tspan id="SvgjsTspan1109">插入</tspan></tspan></text></g></g><g id="SvgjsG1110" transform="translate(42.2062845650712,533.2505398660046)"><path id="SvgjsPath1111" d="M 0 4Q 0 0 4 0L 96 0Q 100 0 100 4L 100 66Q 100 70 96 70L 4 70Q 0 70 0 66Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffff99"></path><g id="SvgjsG1112"><text id="SvgjsText1113" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="80px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="25.55" transform="rotate(0)"><tspan id="SvgjsTspan1114" dy="16" x="50"><tspan id="SvgjsTspan1115">直接插入</tspan></tspan></text></g></g><g id="SvgjsG1116"><path id="SvgjsPath1117" d="M92.2062845650712 603.2505398660046L92.2062845650712 634.2172833538249L92.47189600616188 634.2172833538249L92.47189600616188 665.1840268416452" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1118)"></path></g><g id="SvgjsG1120" transform="translate(26.288914853644116,665.1840268416452)"><path id="SvgjsPath1121" d="M 0 34.612847360623675L 66.18298115251775 0L 132.3659623050355 34.612847360623675L 66.18298115251775 69.22569472124735Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#99ffcc"></path><g id="SvgjsG1122"><text id="SvgjsText1123" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="113px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="17.50897583422991" transform="rotate(0)"><tspan id="SvgjsTspan1124" dy="16" x="66.5"><tspan id="SvgjsTspan1125">++size &gt; </tspan></tspan><tspan id="SvgjsTspan1126" dy="16" x="66.5"><tspan id="SvgjsTspan1127">threshold</tspan></tspan></text></g></g><g id="SvgjsG1128"><path id="SvgjsPath1129" d="M158.65487715868 699.7968742022687L194.87292400391044 699.7968742022687L194.87292400391044 699.6043233547089L231.09097084914092 699.6043233547089" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1130)"></path><rect id="SvgjsRect1132" width="13" height="15" x="188.37292400391044" y="692.2005987784887" fill="#ffffff"></rect><text id="SvgjsText1133" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="13px" fill="#323232" font-weight="400" align="top" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="690.2505987784887" transform="rotate(0)"><tspan id="SvgjsTspan1134" dy="16" x="194.87292400391044"><tspan id="SvgjsTspan1135">是</tspan></tspan></text></g><g id="SvgjsG1136" transform="translate(231.09097084914092,664.6043233547089)"><path id="SvgjsPath1137" d="M 0 4Q 0 0 4 0L 96 0Q 100 0 100 4L 100 66Q 100 70 96 70L 4 70Q 0 70 0 66Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ccffff"></path><g id="SvgjsG1138"><text id="SvgjsText1139" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="80px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="25.55" transform="rotate(0)"><tspan id="SvgjsTspan1140" dy="16" x="50"><tspan id="SvgjsTspan1141">resize()</tspan></tspan></text></g></g><g id="SvgjsG1142"><path id="SvgjsPath1143" d="M92.47189600616188 734.4097215628926L92.47189600616188 767.3545281277351L92.20629516816851 767.3545281277351L92.20629516816851 800.2993346925775" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1144)"></path><rect id="SvgjsRect1146" width="13" height="15" x="85.83909558716519" y="759.8545281277351" fill="#ffffff"></rect><text id="SvgjsText1147" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="13px" fill="#323232" font-weight="400" align="top" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="757.904528127735" transform="rotate(0)"><tspan id="SvgjsTspan1148" dy="16" x="92.33909558716519"><tspan id="SvgjsTspan1149">否</tspan></tspan></text></g><g id="SvgjsG1150" transform="translate(42.48763777434597,800.2993346925775)"><path id="SvgjsPath1151" d="M 0 4Q 0 0 4 0L 95.43731478764508 0Q 99.43731478764508 0 99.43731478764508 4L 99.43731478764508 37.98286050463378Q 99.43731478764508 41.98286050463378 95.43731478764508 41.98286050463378L 4 41.98286050463378Q 0 41.98286050463378 0 37.98286050463378Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffcccc"></path><g id="SvgjsG1152"><text id="SvgjsText1153" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="80px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="11.54143025231689" transform="rotate(0)"><tspan id="SvgjsTspan1154" dy="16" x="50"><tspan id="SvgjsTspan1155">end</tspan></tspan></text></g></g><g id="SvgjsG1156" transform="translate(32.2062951681685,394.77552516876716)"><path id="SvgjsPath1157" d="M 0 40L 60 0L 120 40L 60 80Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#99ffcc"></path><g id="SvgjsG1158"><text id="SvgjsText1159" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="100px" fill="#323232" font-weight="700" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="700" font-style="" opacity="1" y="30.95" transform="rotate(0)"><tspan id="SvgjsTspan1160" dy="16" x="60"><tspan id="SvgjsTspan1161">table[i]==null</tspan></tspan></text></g></g><g id="SvgjsG1162"><path id="SvgjsPath1163" d="M92.17886032591885 354.505683898926L92.17886032591885 374.6406045338466L92.20629516816848 374.6406045338466L92.20629516816848 394.77552516876716" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1164)"></path></g><g id="SvgjsG1166"><path id="SvgjsPath1167" d="M92.20629516816848 474.77552516876716L92.20629516816848 504.0130325173859L92.2062845650712 504.0130325173859L92.2062845650712 533.2505398660046" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1168)"></path><rect id="SvgjsRect1170" width="13" height="15" x="85.70628986661987" y="496.5130325173859" fill="#ffffff"></rect><text id="SvgjsText1171" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="13px" fill="#323232" font-weight="400" align="top" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="494.5630325173859" transform="rotate(0)"><tspan id="SvgjsTspan1172" dy="16" x="92.20628986661987"><tspan id="SvgjsTspan1173">是</tspan></tspan></text></g><g id="SvgjsG1174" transform="translate(588.6189935808675,529.0742794720932)"><path id="SvgjsPath1175" d="M 0 40L 60 0L 120 40L 60 80Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#99ffcc"></path><g id="SvgjsG1176"><text id="SvgjsText1177" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="100px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="22.95" transform="rotate(0)"><tspan id="SvgjsTspan1178" dy="16" x="60"><tspan id="SvgjsTspan1179">链表</tspan><tspan id="SvgjsTspan1180" style="font-size:inherit;">长度</tspan></tspan><tspan id="SvgjsTspan1181" dy="16" x="60"><tspan id="SvgjsTspan1182" style="font-size:inherit;">是否 &gt; 8</tspan></tspan></text></g></g><g id="SvgjsG1183"><path id="SvgjsPath1184" d="M278.80633436080075 604.7530547265438L278.80633436080075 634.9685407840946L92.47189600616188 634.9685407840946L92.47189600616188 665.1840268416452" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1185)"></path></g><g id="SvgjsG1187"><path id="SvgjsPath1188" d="M287.89765319286033 246.5245917363423L287.89765319286033 319.50568389892607L142.17886032591886 319.50568389892607" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1189)"></path></g><g id="SvgjsG1191"><path id="SvgjsPath1192" d="M277.8353743318418 468.3892333060418L277.8353743318418 501.5711440162928L278.80633436080063 501.5711440162928L278.80633436080063 534.7530547265438" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1193)"></path><rect id="SvgjsRect1195" width="13" height="15" x="271.8208543463212" y="494.0711440162928" fill="#ffffff"></rect><text id="SvgjsText1196" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="13px" fill="#323232" font-weight="400" align="top" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="492.1211440162928" transform="rotate(0)"><tspan id="SvgjsTspan1197" dy="16" x="278.3208543463212"><tspan id="SvgjsTspan1198">是</tspan></tspan></text></g><g id="SvgjsG1199"><path id="SvgjsPath1200" d="M472.0445912034174 251.19882860485285L472.0445912034174 268.2292403788735L472.23444821304645 268.2292403788735L472.23444821304645 285.2596521528944" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1201)"></path><rect id="SvgjsRect1203" width="13" height="15" x="465.639519708232" y="260.7292403788735" fill="#ffffff"></rect><text id="SvgjsText1204" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="13px" fill="#323232" font-weight="400" align="top" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="258.7792403788735" transform="rotate(0)"><tspan id="SvgjsTspan1205" dy="16" x="472.139519708232"><tspan id="SvgjsTspan1206">否</tspan></tspan></text></g><g id="SvgjsG1207" transform="translate(404.51103928137957,401.1723505655924)"><path id="SvgjsPath1208" d="M 0 37.23546124185248L 67.51362930278916 0L 135.0272586055783 37.23546124185248L 67.51362930278916 74.47092248370495Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#99ffcc"></path><g id="SvgjsG1209"><text id="SvgjsText1210" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="116px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="20.157815854271004" transform="rotate(0)"><tspan id="SvgjsTspan1211" dy="16" x="68"><tspan id="SvgjsTspan1212">key</tspan></tspan><tspan id="SvgjsTspan1213" dy="16" x="68"><tspan id="SvgjsTspan1214">是否存在</tspan></tspan></text></g></g><g id="SvgjsG1215"><path id="SvgjsPath1216" d="M472.23444821304645 355.2596521528944C 472.23444821304645 373.62492321771913 475.2137644369352 383.0860892347822 472.0246685841692 401.1723505655924" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1217)"></path></g><g id="SvgjsG1219"><path id="SvgjsPath1220" d="M472.0246685841692 475.6432730492974C 475.8583431736693 497.3851220510596 472.4963595010539 508.7571355346381 472.4963595010539 530.834387602629" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1221)"></path><rect id="SvgjsRect1223" width="13" height="15" x="467.1981420136741" y="495.61305417612743" fill="#ffffff"></rect><text id="SvgjsText1224" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="13px" fill="#323232" font-weight="400" align="top" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="493.66305417612745" transform="rotate(0)"><tspan id="SvgjsTspan1225" dy="16" x="473.6981420136741"><tspan id="SvgjsTspan1226">是</tspan></tspan></text></g><g id="SvgjsG1227" transform="translate(422.4963595010534,532.5427209359623)"><path id="SvgjsPath1228" d="M 0 4Q 0 0 4 0L 96 0Q 100 0 100 4L 100 66Q 100 70 96 70L 4 70Q 0 70 0 66Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffff99"></path><g id="SvgjsG1229"><text id="SvgjsText1230" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="80px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="17.55" transform="rotate(0)"><tspan id="SvgjsTspan1231" dy="16" x="50"><tspan id="SvgjsTspan1232">直接覆盖</tspan></tspan><tspan id="SvgjsTspan1233" dy="16" x="50"><tspan id="SvgjsTspan1234">value</tspan></tspan></text></g></g><g id="SvgjsG1235"><path id="SvgjsPath1236" d="M539.5382978869585 438.4078118074449C 560.6902094992261 448.2711101768629 574.5461262121921 438.4078118074449 597.8846784290145 438.4078118074449" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1237)"></path><rect id="SvgjsRect1239" width="13" height="15" x="561.3914979312784" y="434.60654869597664" fill="#ffffff"></rect><text id="SvgjsText1240" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="13px" fill="#323232" font-weight="400" align="top" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="432.65654869597665" transform="rotate(0)"><tspan id="SvgjsTspan1241" dy="16" x="567.8914979312784"><tspan id="SvgjsTspan1242">否</tspan></tspan></text></g><g id="SvgjsG1243" transform="translate(598.3720800006206,403.4078118074449)"><path id="SvgjsPath1244" d="M 0 4Q 0 0 4 0L 96 0Q 100 0 100 4L 100 66Q 100 70 96 70L 4 70Q 0 70 0 66Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffff99"></path><g id="SvgjsG1245"><text id="SvgjsText1246" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="80px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="25.55" transform="rotate(0)"><tspan id="SvgjsTspan1247" dy="16" x="50"><tspan id="SvgjsTspan1248">插入节点</tspan></tspan></text></g></g><g id="SvgjsG1249"><path id="SvgjsPath1250" d="M648.3720800006206 473.40781180744494L648.3720800006206 501.241045639769L648.6189935808675 501.241045639769L648.6189935808675 529.0742794720932" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1251)"></path></g><g id="SvgjsG1253"><path id="SvgjsPath1254" d="M708.6189935808675 569.0742794720929C 730.9691800102455 579.4963425653038 745.609195270068 568.7502359752608 770.2698974609389 568.7502359752608" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1255)"></path><rect id="SvgjsRect1257" width="13" height="15" x="732.0780021103433" y="565.320531383631" fill="#ffffff"></rect><text id="SvgjsText1258" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="13px" fill="#323232" font-weight="400" align="top" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="563.3705313836309" transform="rotate(0)"><tspan id="SvgjsTspan1259" dy="16" x="738.5780021103433"><tspan id="SvgjsTspan1260">是</tspan></tspan></text></g><g id="SvgjsG1261" transform="translate(770.2698974609389,534.0835693085943)"><path id="SvgjsPath1262" d="M 0 4Q 0 0 4 0L 96 0Q 100 0 100 4L 100 66Q 100 70 96 70L 4 70Q 0 70 0 66Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffff99"></path><g id="SvgjsG1263"><text id="SvgjsText1264" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="80px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="25.55" transform="rotate(0)"><tspan id="SvgjsTspan1265" dy="16" x="50"><tspan id="SvgjsTspan1266">转为红黑树</tspan></tspan></text></g></g><g id="SvgjsG1267"><path id="SvgjsPath1268" d="M539.5582205062066 213.96336736300057L701.6397534280169 213.96336736300057L701.6397534280169 212.85917824340066L863.7212863498272 212.85917824340066" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1269)"></path><rect id="SvgjsRect1271" width="13" height="15" x="695.1397534280169" y="205.9112728032006" fill="#ffffff"></rect><text id="SvgjsText1272" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="13px" fill="#323232" font-weight="400" align="top" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="203.96127280320061" transform="rotate(0)"><tspan id="SvgjsTspan1273" dy="16" x="701.6397534280169"><tspan id="SvgjsTspan1274">是</tspan></tspan></text></g><g id="SvgjsG1275"><path id="SvgjsPath1276" d="M281.09097084914094 734.6043233547089L281.09097084914094 821.2907649448944L141.92495256199106 821.2907649448944" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1277)"></path></g><g id="SvgjsG1279"><path id="SvgjsPath1280" d="M913.7212863498272 247.85917824340072L913.7212863498272 634.2993803203002L92.47189600616187 634.2993803203002L92.47189600616187 665.1840268416452" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1281)"></path></g><g id="SvgjsG1283"><path id="SvgjsPath1284" d="M472.4963595010534 602.5427209359623L472.4963595010534 633.8633738888037L92.47189600616187 633.8633738888037L92.47189600616187 665.1840268416452" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1285)"></path></g><g id="SvgjsG1287"><path id="SvgjsPath1288" d="M648.6189935808675 609.0742794720932L648.6189935808675 634.906930934647L92.47189600616187 634.906930934647L92.47189600616187 665.1840268416452" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1289)"></path></g><g id="SvgjsG1291"><path id="SvgjsPath1292" d="M820.2698974609389 604.0835693085943L820.2698974609389 634.6337980751198L92.47189600616187 634.6337980751198L92.47189600616187 665.1840268416452" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1293)"></path></g><g id="SvgjsG1295" transform="translate(645.8254530164936,603.5290459570945)"><path id="SvgjsPath1296" d="M 0 0L 36.66666666666629 0L 36.66666666666629 31.086706686489833L 0 31.086706686489833Z" stroke="none" fill="none"></path><g id="SvgjsG1297"><text id="SvgjsText1298" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="37px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="6.0933533432449165" transform="rotate(0)"><tspan id="SvgjsTspan1299" dy="16" x="18.5"><tspan id="SvgjsTspan1300">否</tspan></tspan></text></g></g><g id="SvgjsG1301" transform="translate(64.71434190538197,26.019572787814674)"><path id="SvgjsPath1302" d="M 0 0L 235.55555555555554 0L 235.55555555555554 40.33058232240272L 0 40.33058232240272Z" stroke="none" fill="none"></path><g id="SvgjsG1303"><text id="SvgjsText1304" font-family="微软雅黑" text-anchor="middle" font-size="16px" width="236px" fill="#323232" font-weight="700" align="middle" anchor="middle" family="微软雅黑" size="16px" weight="700" font-style="" opacity="1" y="7.765291161201359" transform="rotate(0)"><tspan id="SvgjsTspan1305" dy="20" x="118"><tspan id="SvgjsTspan1306">计算索引 + 逻辑判断 + 扩容</tspan></tspan></text></g></g><g id="SvgjsG1307" transform="translate(482.4921196831599,25.00166816622921)"><path id="SvgjsPath1308" d="M 0 0L 151.11111111111111 0L 151.11111111111111 41.11111111111111L 0 41.11111111111111Z" stroke="none" fill="none"></path><g id="SvgjsG1309"><text id="SvgjsText1310" font-family="微软雅黑" text-anchor="middle" font-size="16px" width="152px" fill="#323232" font-weight="700" align="middle" anchor="middle" family="微软雅黑" size="16px" weight="700" font-style="" opacity="1" y="8.155555555555553" transform="rotate(0)"><tspan id="SvgjsTspan1311" dy="20" x="76"><tspan id="SvgjsTspan1312">链表</tspan></tspan></text></g></g><g id="SvgjsG1313" transform="translate(788.0476752387157,25.629308393460477)"><path id="SvgjsPath1314" d="M 0 0L 151.11111111111111 0L 151.11111111111111 41.11111111111111L 0 41.11111111111111Z" stroke="none" fill="none"></path><g id="SvgjsG1315"><text id="SvgjsText1316" font-family="微软雅黑" text-anchor="middle" font-size="16px" width="152px" fill="#323232" font-weight="700" align="middle" anchor="middle" family="微软雅黑" size="16px" weight="700" font-style="" opacity="1" y="8.155555555555553" transform="rotate(0)"><tspan id="SvgjsTspan1317" dy="20" x="76"><tspan id="SvgjsTspan1318">红黑树</tspan></tspan></text></g></g></svg></p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">V</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">K</span> key<span class="token punctuation">,</span> <span class="token class-name">V</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">putVal</span><span class="token punctuation">(</span><span class="token function">hash</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token function">hash</span><span class="token punctuation">(</span><span class="token class-name">Object</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> h<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>key <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token punctuation">(</span>h <span class="token operator">=</span> key<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>h <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//实现Map.put和相关方法</span>
<span class="token keyword">final</span> <span class="token class-name">V</span> <span class="token function">putVal</span><span class="token punctuation">(</span><span class="token keyword">int</span> hash<span class="token punctuation">,</span> <span class="token class-name">K</span> key<span class="token punctuation">,</span> <span class="token class-name">V</span> value<span class="token punctuation">,</span> <span class="token keyword">boolean</span> onlyIfAbsent<span class="token punctuation">,</span> <span class="token keyword">boolean</span> evict<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> tab<span class="token punctuation">;</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> p<span class="token punctuation">;</span> <span class="token keyword">int</span> n<span class="token punctuation">,</span> i<span class="token punctuation">;</span>
<span class="token comment">// 步骤1：table == null ?	</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>tab <span class="token operator">=</span> table<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> <span class="token punctuation">(</span>n <span class="token operator">=</span> tab<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token comment">//table未初始化或者长度为0，进行扩容</span>
		n <span class="token operator">=</span> <span class="token punctuation">(</span>tab <span class="token operator">=</span> <span class="token function">resize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>
<span class="token comment">// 步骤2：计算index, table[index] == null ?</span>
    <span class="token comment">// (n ‐ 1) &amp; hash 确定元素存放在哪个桶中,桶为空,新生成结点放入桶中</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>p <span class="token operator">=</span> tab<span class="token punctuation">[</span>i <span class="token operator">=</span> <span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> hash<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
		tab<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">newNode</span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">else</span> <span class="token punctuation">{</span><span class="token comment">// 桶中已经存在元素</span>
		<span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> e<span class="token punctuation">;</span> <span class="token class-name">K</span> k<span class="token punctuation">;</span>
<span class="token comment">// 步骤3：节点key存在，直接覆盖value</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>p<span class="token punctuation">.</span>hash <span class="token operator">==</span> hash <span class="token operator">&amp;&amp;</span> <span class="token comment">// 与桶中第一个元素(数组中的结点)进行比较 (hash, ==, equals)</span>
            <span class="token punctuation">(</span><span class="token punctuation">(</span>k <span class="token operator">=</span> p<span class="token punctuation">.</span>key<span class="token punctuation">)</span> <span class="token operator">==</span> key <span class="token operator">||</span> <span class="token punctuation">(</span>key <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> key<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            e <span class="token operator">=</span> p<span class="token punctuation">;</span><span class="token comment">// 将第一个元素赋值给e，用e来记录</span>
<span class="token comment">// 步骤4：否则判断该链是否为红黑树</span>
        <span class="token comment">// hash值不相等，即key不相等；为红黑树结点</span>
        <span class="token comment">// 如果当前元素类型为TreeNode，表示为红黑树，putTreeVal返回待存放的node, e可能为null</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>p <span class="token keyword">instanceof</span> <span class="token class-name">TreeNode</span><span class="token punctuation">)</span>
            <span class="token comment">// 放入树中</span>
            e <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">TreeNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span>p<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">putTreeVal</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> tab<span class="token punctuation">,</span> hash<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 步骤5：否则确定该链为链表,遍历列表做替换或append</span>
        <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> binCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">;</span> <span class="token operator">++</span>binCount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e <span class="token operator">=</span> p<span class="token punctuation">.</span>next<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//遍历 + 判断是否到达链表的尾部</span>
                    p<span class="token punctuation">.</span>next <span class="token operator">=</span> <span class="token function">newNode</span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 在尾部插入新结点</span>
                    <span class="token comment">//判断链表的长度是否达到转化红黑树的临界值，临界值为8</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>binCount <span class="token operator">&gt;=</span> TREEIFY_THRESHOLD <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">// -1 for 1st</span>
                        <span class="token function">treeifyBin</span><span class="token punctuation">(</span>tab<span class="token punctuation">,</span> hash<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//链表结构转树形结构</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span><span class="token comment">// 跳出循环</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>hash <span class="token operator">==</span> hash <span class="token operator">&amp;&amp;</span> <span class="token comment">// 与节点进行比较 (hash, ==, equals)</span>
                    <span class="token punctuation">(</span><span class="token punctuation">(</span>k <span class="token operator">=</span> e<span class="token punctuation">.</span>key<span class="token punctuation">)</span> <span class="token operator">==</span> key <span class="token operator">||</span> <span class="token punctuation">(</span>key <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> key<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
					<span class="token keyword">break</span><span class="token punctuation">;</span><span class="token comment">// 相等，跳出循环</span>
				p <span class="token operator">=</span> e<span class="token punctuation">;</span><span class="token comment">// 与前面的e = p.next组合; 用于遍历链表</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>e <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// existing mapping for key</span>
			<span class="token class-name">V</span> oldValue <span class="token operator">=</span> e<span class="token punctuation">.</span>value<span class="token punctuation">;</span><span class="token comment">// 记录e的value</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>onlyIfAbsent <span class="token operator">||</span> oldValue <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token comment">// onlyIfAbsent为false或者旧值为null</span>
			e<span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span><span class="token comment">//用新值替换旧值</span>
			<span class="token function">afterNodeAccess</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 访问后回调函数</span>
			<span class="token keyword">return</span> oldValue<span class="token punctuation">;</span><span class="token comment">// 返回旧值</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token operator">++</span>modCount<span class="token punctuation">;</span><span class="token comment">// 结构性修改次数叠加</span>
<span class="token comment">// 步骤6：根据size判断是否扩容</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">++</span>size <span class="token operator">&gt;</span> threshold<span class="token punctuation">)</span><span class="token comment">// 实际大小大于阈值则扩容</span>
		<span class="token function">resize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">afterNodeInsertion</span><span class="token punctuation">(</span>evict<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 插入后回调函数</span>
	<span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br></div></div><p>①.判断键值对数组table[i]是否为空或为null，否则执行resize()进行扩容；</p> <p>②.根据键值key计算hash值得到插入的数组索引i，如果table[i]==null，直接新建节点添加，转向⑥，如果table[i]不为空，转向③；</p> <p>③.判断table[i]的首个元素是否和key一样，如果相同直接覆盖value，否则转向④，这里的相同指的是hashCode以及equals；</p> <p>④.判断table[i] 是否为treeNode，即table[i] 是否是红黑树，如果是红黑树，则直接在树中插入键值对，否则转向⑤；</p> <p>⑤.遍历table[i]，判断链表长度是否大于8，大于8的话把链表转换为红黑树，在红黑树中执行插入操作，否则进行链表的插入操作；遍历过程中若发现key已经存在直接覆盖value即可；</p> <p>⑥.插入成功后，判断实际存在的键值对数量size是否超多了 大容量threshold，如果超过，进行扩容。</p> <h3 id="hashmap的扩容操作是怎么实现的"><a href="#hashmap的扩容操作是怎么实现的" class="header-anchor">#</a> HashMap的扩容操作是怎么实现的？</h3> <p>①.在jdk1.8中，resize方法是在hashmap中的键值对大于阈值时或者初始化时，就调用resize方法进行扩容；</p> <p>②.每次扩展的时候，都是扩展2倍；</p> <p>③.扩展后Node对象的位置要么在原位置，要么移动到原偏移量两倍的位置。在putVal()中，我们看到在这个函数里面使用到了2次resize()方法，resize()方法表示的在进行第一次初始化时会对其进行扩容，或者当该数组的实际大小大于其临界值值(第一次为12),这个时候在扩容的同时也会伴随的桶上面的元素进行重新分发，这也是JDK1.8版本的一个优化的地方，在1.7中，扩容之后需要重新去计算其Hash值，根据Hash值对其进行分发，但在1.8版本中，则是根据在同一个桶的位置中进行判断(e.hash &amp; oldCap)是否为0，重新进行hash分配后，该元素的位置要么停留在原始位置，要么移动到原始位置+增加的数组大小这个位置上</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">final</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">resize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> oldTab <span class="token operator">=</span> table<span class="token punctuation">;</span><span class="token comment">//oldTab指向hash桶数组</span>
    <span class="token keyword">int</span> oldCap <span class="token operator">=</span> <span class="token punctuation">(</span>oldTab <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> oldTab<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    <span class="token keyword">int</span> oldThr <span class="token operator">=</span> threshold<span class="token punctuation">;</span>
    <span class="token keyword">int</span> newCap<span class="token punctuation">,</span> newThr <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>oldCap <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//如果oldCap不为空的话，就是hash桶数组不为空</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>oldCap <span class="token operator">&gt;=</span> MAXIMUM_CAPACITY<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//如果大于最大容量了，就赋值为整数最大的阈值</span>
            threshold <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">;</span>
            <span class="token keyword">return</span> oldTab<span class="token punctuation">;</span><span class="token comment">//返回, 不再处理</span>
        <span class="token punctuation">}</span>
		<span class="token comment">//扩容后没有超长,且大于16,则扩充阈值</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>newCap <span class="token operator">=</span> oldCap <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token generics"><span class="token punctuation">&lt;</span> MAXIMUM_CAPACITY <span class="token operator">&amp;</span><span class="token operator">&amp;</span>
                 oldCap <span class="token punctuation">&gt;</span></span><span class="token operator">=</span> DEFAULT_INITIAL_CAPACITY<span class="token punctuation">)</span>
            newThr <span class="token operator">=</span> oldThr <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// double threshold</span>
    <span class="token punctuation">}</span><span class="token comment">// 旧容量为0,threshold&gt;0,说明构造时指定容量,threshold已经被初始化成最小2的n次幂</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>oldThr <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">// initial capacity was placed in threshold</span>
        newCap <span class="token operator">=</span> oldThr<span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token punctuation">{</span>               <span class="token comment">// zero initial threshold signifies using defaults</span>
        newCap <span class="token operator">=</span> DEFAULT_INITIAL_CAPACITY<span class="token punctuation">;</span> <span class="token comment">// 无参构造会走这个分支</span>
        newThr <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>DEFAULT_LOAD_FACTOR <span class="token operator">*</span> DEFAULT_INITIAL_CAPACITY<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>newThr <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">// 有参构造第一次初始化时候计算threshold 例:4默认得到3; 4,1.25会得到5</span>
        <span class="token keyword">float</span> ft <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>newCap <span class="token operator">*</span> loadFactor<span class="token punctuation">;</span>
        newThr <span class="token operator">=</span> <span class="token punctuation">(</span>newCap <span class="token operator">&lt;</span> MAXIMUM_CAPACITY <span class="token operator">&amp;&amp;</span> ft <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>MAXIMUM_CAPACITY <span class="token operator">?</span>
                  <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>ft <span class="token operator">:</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    threshold <span class="token operator">=</span> newThr<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@SuppressWarnings</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;rawtypes&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;unchecked&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> newTab <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token punctuation">[</span>newCap<span class="token punctuation">]</span><span class="token punctuation">;</span>
    table <span class="token operator">=</span> newTab<span class="token punctuation">;</span><span class="token comment">//以新容量扩充本HashMap数组长度 (此时数组为空)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>oldTab <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//旧数组不为空则数据迁移</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> oldCap<span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> e<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e <span class="token operator">=</span> oldTab<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">// null判断 + 遍历时赋给临时变量e</span>
                oldTab<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span><span class="token comment">// 方便GC回收</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>next <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token comment">// 判断是否单节点链表</span>
                    newTab<span class="token punctuation">[</span>e<span class="token punctuation">.</span>hash <span class="token operator">&amp;</span> <span class="token punctuation">(</span>newCap <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> e<span class="token punctuation">;</span><span class="token comment">//迁移数据</span>
                <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>e <span class="token keyword">instanceof</span> <span class="token class-name">TreeNode</span><span class="token punctuation">)</span><span class="token comment">//如果是红黑树, 按红黑树处理</span>
                    <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">TreeNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span>e<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> newTab<span class="token punctuation">,</span> j<span class="token punctuation">,</span> oldCap<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token comment">// preserve order</span>
                    <span class="token comment">// loHead,loTail (低位)代表扩容后不用变换下标, 见注1</span>
                    <span class="token comment">// hiHead,hiTail 代表扩容后变换下标, 见注1</span>
                    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> loHead <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span> loTail <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
                    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> hiHead <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span> hiTail <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
                    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> next<span class="token punctuation">;</span>
                    <span class="token keyword">do</span> <span class="token punctuation">{</span> <span class="token comment">// 遍历链表, 根据hash值将原链表拆成两个, 分别放原位和偏移位</span>
                        next <span class="token operator">=</span> e<span class="token punctuation">.</span>next<span class="token punctuation">;</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>hash <span class="token operator">&amp;</span> oldCap<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//e.hash小于旧容量,认为在低位</span>
                            <span class="token keyword">if</span> <span class="token punctuation">(</span>loTail <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
                                loHead <span class="token operator">=</span> e<span class="token punctuation">;</span>
                            <span class="token keyword">else</span>
                                loTail<span class="token punctuation">.</span>next <span class="token operator">=</span> e<span class="token punctuation">;</span>
                            loTail <span class="token operator">=</span> e<span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        <span class="token keyword">else</span> <span class="token punctuation">{</span><span class="token comment">// 否则在高位</span>
                            <span class="token keyword">if</span> <span class="token punctuation">(</span>hiTail <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
                                hiHead <span class="token operator">=</span> e<span class="token punctuation">;</span>
                            <span class="token keyword">else</span>
                                hiTail<span class="token punctuation">.</span>next <span class="token operator">=</span> e<span class="token punctuation">;</span>
                            hiTail <span class="token operator">=</span> e<span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e <span class="token operator">=</span> next<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>loTail <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//保留原位</span>
                        loTail<span class="token punctuation">.</span>next <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
                        newTab<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> loHead<span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>hiTail <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//迁移至偏移量</span>
                        hiTail<span class="token punctuation">.</span>next <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
                        newTab<span class="token punctuation">[</span>j <span class="token operator">+</span> oldCap<span class="token punctuation">]</span> <span class="token operator">=</span> hiHead<span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> newTab<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br></div></div><h3 id="hashmap是怎么解决哈希冲突的"><a href="#hashmap是怎么解决哈希冲突的" class="header-anchor">#</a> HashMap是怎么解决哈希冲突的？</h3> <p>答：在解决这个问题之前，我们首先需要知道什么是哈希冲突，而在了解哈希冲突之前我们还要知道什么是哈希才行；什么是哈希？</p> <p>Hash，一般翻译为“散列”，也有直接音译为“哈希”的，这就是把任意长度的输入通过散列算法，变换成固定长度的输出，该输出就是散列值（哈希值）；这种转换是一种压缩映射，也就是，散列值的空间通常远小于输入的空间，不同的输入可能会散列成相同的输出，所以不可能从散列值来唯一的确定输入值。简单的说就是一种将任意长度的消息压缩到某一固定长度的消息摘要的函数。</p> <p>所有散列函数都有如下一个基本特性**：根据同一散列函数计算出的散列值如果不同，那么输入值肯定也不同。但是，根据同一散列函数计算出的散列值如果相同，输入值不一定相同**。</p> <h4 id="什么是哈希冲突"><a href="#什么是哈希冲突" class="header-anchor">#</a> 什么是哈希冲突？</h4> <p>当两个不同的输入值，根据同一散列函数计算出相同的散列值的现象，我们就把它叫做碰撞（哈希碰撞）。</p> <h4 id="hashmap的数据结构"><a href="#hashmap的数据结构" class="header-anchor">#</a> HashMap的数据结构</h4> <p>在Java中，保存数据有两种比较简单的数据结构：数组和链表。数组的特点是：寻址容易，插入和删除困难；链表的特点是：寻址困难，但插入和删除容易；所以我们将数组和链表结合在一起，发挥两者各自的优势，使用一种叫做链地址法的方式可以解决哈希冲突：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>bucket at hash(key) = 0: [] - node
bucket at hash(key) = 1: [] - node - node - node
bucket at hash(key) = 2: [] - node
bucket at hash(key) = 3: []
bucket at hash(key) = 4: [] - node - node
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>这样我们就可以将拥有相同哈希值的对象组织成一个链表放在hash值所对应的 bucket下，但相比于hashCode返回的int类型，我们HashMap初始的容量大小DEFAULT_INITIAL_CAPACITY = 1 &lt;&lt; 4（即2的四次方16）要远小于int类型的范围，所以我们如果只是单纯的用hashCode取余来获取对应的bucket这将会大大增加哈希碰撞的概率，并且最坏情况下还会将HashMap变成一个单链表，所以我们还需要对hashCode作一定的优化 hash()函数</p> <p>上面提到的问题，主要是因为如果使用hashCode取余，那么相当于参与运算的只有hashCode的低位，高位是没有起到任何作用的，所以我们的思路就是让 hashCode取值出的高位也参与运算，进一步降低hash碰撞的概率，使得数据分布更平均，我们把这样的操作称为扰动，在JDK 1.8中的hash()函数如下：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token function">hash</span><span class="token punctuation">(</span><span class="token class-name">Object</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">int</span> h<span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token punctuation">(</span>key <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token punctuation">(</span>h <span class="token operator">=</span> key<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>h <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>这比在JDK 1.7中，更为简洁，相比在1.7中的4次位运算，5次异或运算（9次扰动），在1.8中，只进行了1次位运算和1次异或运算（2次扰动）；</p> <h4 id="jdk1-8新增红黑树"><a href="#jdk1-8新增红黑树" class="header-anchor">#</a> JDK1.8新增红黑树</h4> <p>通过上面的链地址法（使用散列表）和扰动函数我们成功让我们的数据分布更平均，哈希碰撞减少，但是当我们的HashMap中存在大量数据时，加入我们某个 bucket下对应的链表有n个元素，那么遍历时间复杂度就为O(n)，为了针对这个问题，JDK1.8在HashMap中新增了红黑树的数据结构，进一步使得遍历复杂度降低至O(logn);</p> <p>简单总结一下HashMap是使用了哪些方法来有效解决哈希冲突的：</p> <ol><li>使用链地址法（使用散列表）来链接拥有相同hash值的数据；</li> <li>使用2次扰动函数（hash函数）来降低哈希冲突的概率，使得数据分布更平均；</li> <li>引入红黑树进一步降低遍历的时间复杂度，使得遍历更快；</li></ol> <h3 id="能否使用任何类作为-map-的-key"><a href="#能否使用任何类作为-map-的-key" class="header-anchor">#</a> 能否使用任何类作为 Map 的 key？</h3> <p>可以使用任何类作为 Map 的 key，然而在使用之前，需要考虑以下几点: 如果类重写了 equals() 方法，也应该重写 hashCode() 方法。类的所有实例需要遵循与 equals() 和 hashCode() 相关的规则。</p> <p>如果一个类没有使用 equals()，不应该在 hashCode() 中使用它。</p> <p>用户自定义Key, 最佳实践是使之为不可变的，这样 hashCode() 值可以被缓存起来，拥有更好的性能。不可变的类也可以确保 hashCode() 和 equals() 在未来不会改变，这样就会解决与可变相关的问题了。</p> <h3 id="为什么hashmap中string、integer这样的包装类适合作为key"><a href="#为什么hashmap中string、integer这样的包装类适合作为key" class="header-anchor">#</a> 为什么HashMap中String、Integer这样的包装类适合作为Key？</h3> <p>答：String、Integer等包装类的特性能够保证Hash值的不可更改性和计算准确性，能够有效的减少Hash碰撞的几率</p> <ol><li>都是final类型，即不可变性，保证key的不可更改性，不会存在获取 hash值不同的情况</li></ol> <p>内部已重写了equals()、hashCode()等方法，遵守了HashMap内部的规范（不清楚可以去上面看看putValue的过程），不容易出现Hash值计算错误的情况</p> <h3 id="如果使用object作为hashmap的key-应该怎么办呢"><a href="#如果使用object作为hashmap的key-应该怎么办呢" class="header-anchor">#</a> 如果使用Object作为HashMap的Key，应该怎么办呢？</h3> <p>答：重写hashCode()和equals()方法</p> <ol><li>重写hashCode()是因为需要计算存储数据的存储位置，需要注意不要试图从散列码计算中排除掉一个对象的关键部分来提高性能，这样虽然能更快但可能会导致更多的Hash碰撞；</li> <li>重写equals()方法，需要遵守自反性、对称性、传递性、一致性以及对于任何非null的引用值x，x.equals(null)必须返回false的这几个特性，目的是为了保证key在哈希表中的唯一性</li></ol> <h3 id="hashmap为什么不直接使用hashcode-处理后的哈希值直接作为table的下标"><a href="#hashmap为什么不直接使用hashcode-处理后的哈希值直接作为table的下标" class="header-anchor">#</a> HashMap为什么不直接使用hashCode()处理后的哈希值直接作为table的下标？</h3> <p>答：hashCode()方法返回的是int整数类型，其范围为-(2 ^ 31)~(2 ^ 31 - 1)，约有40亿个映射空间，而HashMap的容量范围是在16（初始化默认值）~2 ^ 30，HashMap通常情况下是取不到大值的，并且设备上也难以提供这么多的存储空间，从而导致通过hashCode()计算出的哈希值可能不在数组大小范围内，进而无法匹配存储位置；</p> <p>那怎么解决呢？</p> <ol><li>HashMap自己实现了自己的hash()方法，通过两次扰动使得它自己的哈希值高低位自行进行异或运算，降低哈希碰撞概率也使得数据分布更平均；</li> <li>在保证数组长度为2的幂次方的时候，使用hash()运算之后的值h&amp;(length-1)来获取数组下标的方式进行存储，这样一来是比取余操作更加有效率，二来也是因为只有当数组长度为2的幂次方时，h&amp;(length-1)才等价于h%length，三来解决了“哈希值与数组大小范围不匹配&quot;的问题</li></ol> <h3 id="hashmap-的长度为什么是2的幂次方"><a href="#hashmap-的长度为什么是2的幂次方" class="header-anchor">#</a> HashMap 的长度为什么是2的幂次方</h3> <p>为了能让 HashMap 存取高效，尽量较少碰撞，也就是要尽量把数据分配均匀，每个链表/红黑树长度大致相同。这个实现就是把数据存到哪个链表/红黑树中的算法。</p> <p>这个算法应该如何设计呢？我们首先可能会想到采用%取余的操作来实现。但是，重点来了：“取余(%)操作中如果除数是2的幂次则等价于与其除数减一的与(&amp;)操作</p> <p>也就是说 hash%length==hash&amp;(length-1)的前提是 length 是2的 n 次方；并且 采用二进制位操作 &amp;，相对于%能够提高运算效率，这就解释了 HashMap 的长度为什么是2的幂次方。</p> <p>那为什么是两次扰动呢？答：这样就是加大哈希值低位的随机性，使得分布更均匀，从而提高对应数组存储下标位置的随机性&amp;均匀性，  终减少Hash冲突，两次就够了，已经达到了高位低位同时参与运算的目的</p> <h3 id="hashmap-与-hashtable-有什么区别"><a href="#hashmap-与-hashtable-有什么区别" class="header-anchor">#</a> HashMap 与 HashTable 有什么区别？</h3> <ol><li><p>线程安全： HashMap 是非线程安全的，HashTable 是线程安全的；HashTable 内部的方法基本都经过 synchronized 修饰。（如果你要保证线程安全的话就使用 ConcurrentHashMap 吧！）；</p></li> <li><p>效率： 因为线程安全的问题，HashMap 要比 HashTable 效率高一点。另外，HashTable 基本被淘汰，不要在代码中使用它；</p></li> <li><p>对Null key 和Null value的支持： HashMap 中，null 可以作为键，这样的键只有一个，可以有一个或多个键所对应的值为 null。但是在 HashTable 中 put 进的键值只要有一个 null，直接抛 NullPointerException。</p></li> <li><p>**初始容量大小和每次扩充容量大小的不同 **：</p> <p>①创建时如果不指定容量初始值，Hashtable 默认的初始大小为11，之后每次扩充，容量变为原来的2n+1。HashMap 默认的初始化大小为16。之后每次扩充，容量变为原来的2倍。</p> <p>②创建时如果给定了容量初始值，那么 Hashtable 会直接使用你给定的大小，而 HashMap 会将其扩充为2的幂次方大小。也就是说 HashMap 总是使用2的幂作为哈希表的大小。</p></li> <li><p>底层数据结构： JDK1.8 以后的 HashMap 在解决哈希冲突时有了较大的变化，当链表长度大于阈值8时，将链表转化为红黑树，以减少搜索时间。Hashtable 没有这样的机制。</p></li> <li><p>推荐使用：在 Hashtable 的类注释可以看到，Hashtable 是保留类不建议使用，推荐在单线程环境下使用 HashMap 替代，如果需要多线程使用则用 ConcurrentHashMap 替代。</p></li></ol> <h3 id="如何决定使用-hashmap-还是treemap"><a href="#如何决定使用-hashmap-还是treemap" class="header-anchor">#</a> 如何决定使用 HashMap 还是TreeMap？</h3> <p>对于在Map中插入、删除和定位元素这类操作，HashMap是 好的选择。然而，假如你需要对一个有序的key集合进行遍历，TreeMap是更好的选择。基于你的collection的大小，也许向HashMap中添加元素会更快，将map换为TreeMap允许进行有序key的遍历!</p> <h3 id="hashmap-和-concurrenthashmap-的区别"><a href="#hashmap-和-concurrenthashmap-的区别" class="header-anchor">#</a> HashMap 和 ConcurrentHashMap 的区别</h3> <ol><li><p>ConcurrentHashMap对整个桶数组进行了分割分段(Segment)，然后在每一个分段上都用lock锁进行保护，相对于HashTable的synchronized 锁的粒度更精细了一些，并发性能更好，而HashMap没有锁机制，不是线程安全的。（JDK1.8之后ConcurrentHashMap启了一种全新的方式实现,利用CAS算法。）</p></li> <li><p>HashMap的键值对允许有null，但是ConcurrentHashMap都不允许。</p></li></ol> <h3 id="concurrenthashmap-和-hashtable-的区别"><a href="#concurrenthashmap-和-hashtable-的区别" class="header-anchor">#</a> ConcurrentHashMap 和 Hashtable 的区别？</h3> <p>ConcurrentHashMap 和 Hashtable 的区别主要体现在实现线程安全的方式上不同。</p> <p>底层数据结构：</p> <p>JDK1.7的 ConcurrentHashMap 底层采用 分段的数组+链表 实现，JDK1.8 采用的数据结构跟HashMap1.8的结构一样，数组+链表/红黑树。</p> <p>Hashtable 和 JDK1.8 之前的 HashMap 的底层数据结构类似都是采用 数组+链表 的形式，数组是 HashMap 的主体，链表则是主要为了解决哈希冲突而存在的；</p> <p>实现线程安全的方式（重要）：</p> <p>① 在JDK1.7的时候，ConcurrentHashMap（分段锁） 对整个桶数组进行了分割分段(Segment)，每一把锁只锁容器其中一部分数据，多线程访问容器里不同数据段的数据，就不会存在锁竞争，提高并发访问率。（默认分配16个Segment，比Hashtable效率提高16倍。） 到了 JDK1.8 的时候已经摒弃了Segment的概念，而是直接用 Node 数组+链表+红黑树的数据结构来实现，并发控制使用 synchronized 和 CAS 来操作。（JDK1.6以后 synchronized锁做了很多优化） 整个看起来就像是优化过且线程安全的 HashMap，虽然在JDK1.8中还能看到 Segment 的数据结构，但是已经简化了属性，只是为了兼容旧版本；</p> <p>② Hashtable(同一把锁) :使用 synchronized 来保证线程安全，效率较低。当一个线程访问同步方法时，其他线程也访问同步方法，可能会进入阻塞或轮询状态，如使用 put 添加元素，另一个线程不能使用 put 添加元素，也不能使用 get，竞争会越来越激烈效率越低。</p> <p>两者的对比图：</p> <p>HashTable:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>   ----HashTable 全表锁-- 
 /				         \
e1 e2 null e4 e5 e6 null ...
    |       |
   e7      e8
    |
   e9
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>JDK1.7的ConcurrentHashMap：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>   -segment-	   -segment-	-segment-	....
 /			 \	 /           \ /		  \
e1 e2 null e4 e5 e6 null e7 e8 e9 e10 e11 null ....
    |       |			  |			
   e7      e8			 e20
    |
   e9
HashEntry数组----HashEntry数组---HashEntry数组---...
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>JDK1.8的ConcurrentHashMap（TreeBin: 红黑二叉树节点 Node: 链表节点）：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>lock lock lock lock lock lock lock ...
e1   e2   null e4   e5   e6   null ...
    |       |			  |			
   e7      e8			 e20
    |
   e9
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>答：ConcurrentHashMap 结合了 HashMap 和 HashTable 二者的优势。 HashMap 没有考虑同步，HashTable 考虑了同步的问题。但是 HashTable 在每次同步执行时都要锁住整个结构。 ConcurrentHashMap 锁的方式是稍微细粒度的。</p> <h3 id="concurrenthashmap-底层具体实现知道吗-实现原理是什么"><a href="#concurrenthashmap-底层具体实现知道吗-实现原理是什么" class="header-anchor">#</a> ConcurrentHashMap 底层具体实现知道吗？实现原理是什么？</h3> <p>JDK1.7</p> <p>首先将数据分为一段一段的存储，然后给每一段数据配一把锁，当一个线程占用锁访问其中一个段数据时，其他段的数据也能被其他线程访问。采用Segment + HashEntry的方式进行实现，结构如下：</p> <p>一个 ConcurrentHashMap 里包含一个 Segment 数组。Segment 的结构和 HashMap类似，是一种数组和链表结构，一个 Segment 包含一个 HashEntry 数组，每个 HashEntry 是一个链表结构的元素，每个 Segment 守护着一个 HashEntry数组里的元素，当对 HashEntry 数组的数据进行修改时，必须首先获得对应的 Segment的锁。</p> <ol><li><p>该类包含两个静态内部类 HashEntry 和 Segment ；前者用来封装映射表的键值对，后者用来充当锁的角色；</p></li> <li><p>Segment 是一种可重入的锁 ReentrantLock，每个 Segment 守护一个HashEntry 数组里得元素，当对 HashEntry 数组的数据进行修改时，必须首先获得对应的 Segment 锁。</p></li></ol> <p>JDK1.8</p> <p>在JDK1.8中，放弃了Segment臃肿的设计，取而代之的是采用Node + CAS + Synchronized来保证并发安全进行实现，synchronized只锁定当前链表或红黑二叉树的首节点，这样只要hash不冲突，就不会产生并发，效率又提升N 倍。</p> <p>看插入元素过程（建议去看看源码）：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>f <span class="token operator">=</span> <span class="token function">tabAt</span><span class="token punctuation">(</span>tab<span class="token punctuation">,</span> i <span class="token operator">=</span> <span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> hash<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//如果相应位置的Node还没有初始化, 则调用CAS插入相应的数据;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">casTabAt</span><span class="token punctuation">(</span>tab<span class="token punctuation">,</span> i<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token keyword">break</span><span class="token punctuation">;</span>	<span class="token comment">// no lock when adding to empty bin</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>如果相应位置的Node不为空，且当前该节点不处于移动状态，则对该节点加synchronized锁，如果该节点的hash不小于0，则遍历链表更新节点或插入新节点；</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>fh <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	binCount <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> e <span class="token operator">=</span> f<span class="token punctuation">;</span><span class="token punctuation">;</span> <span class="token operator">++</span>binCount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">K</span> ek<span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>hash <span class="token operator">==</span> hash <span class="token operator">&amp;&amp;</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ek <span class="token operator">=</span> e<span class="token punctuation">.</span>key<span class="token punctuation">)</span> <span class="token operator">==</span> key <span class="token operator">||</span> <span class="token punctuation">(</span>ek <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> key<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>ek<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			oldVal <span class="token operator">=</span> e<span class="token punctuation">.</span>val<span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>onlyIfAbsent<span class="token punctuation">)</span>
                e<span class="token punctuation">.</span>val <span class="token operator">=</span> value<span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
    	<span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> pred <span class="token operator">=</span> e<span class="token punctuation">;</span>
    	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e <span class="token operator">=</span> e<span class="token punctuation">.</span>next<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    		pred<span class="token punctuation">.</span>next <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    		<span class="token keyword">break</span><span class="token punctuation">;</span>
    	<span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><ol><li>如果该节点是TreeBin类型的节点，说明是红黑树结构，则通过 putTreeVal方法往红黑树中插入节点；如果binCount不为0，说明put操作对数据产生了影响，如果当前链表的个数达到8个，则通过treeifyBin方法转化为红黑树，如果oldVal不为空，说明是一次更新操作，没有对元素个数产生影响，则直接返回旧值；</li> <li>如果插入的是一个新节点，则执行addCount()方法尝试更新元素个数 baseCount；</li></ol> <h2 id="辅助工具类"><a href="#辅助工具类" class="header-anchor">#</a> 辅助工具类</h2> <h3 id="array-和-arraylist-有何区别"><a href="#array-和-arraylist-有何区别" class="header-anchor">#</a> Array 和 ArrayList 有何区别？</h3> <ul><li>Array 可以存储基本数据类型和对象，ArrayList 只能存储对象。</li> <li>Array 是指定固定大小的，而 ArrayList 大小是自动扩展的。</li> <li>Array 内置方法没有 ArrayList 多，比如 addAll、removeAll、iteration 等方法只有 ArrayList 有。</li></ul> <p>对于基本类型数据，集合使用自动装箱来减少编码工作量。但是，当处理固定大小的基本数据类型的时候，这种方式相对比较慢。</p> <h3 id="如何实现-array-和-list-之间的转换"><a href="#如何实现-array-和-list-之间的转换" class="header-anchor">#</a> 如何实现 Array 和 List 之间的转换？</h3> <ul><li>Array 转 List： Arrays. asList(array) ；</li> <li>List 转 Array：List 的 toArray() 方法。</li></ul> <h3 id="comparable-和-comparator的区别"><a href="#comparable-和-comparator的区别" class="header-anchor">#</a> comparable 和 comparator的区别？</h3> <ul><li>comparable接口实际上是出自java.lang包，它有一个 compareTo(Object obj)方法用来排序</li> <li>comparator接口实际上是出自 java.util 包，它有一个compare(Object obj1, Object obj2)方法用来排序</li></ul> <p>一般我们需要对一个集合使用自定义排序时，我们就要重写compareTo方法或 compare方法，当我们需要对某一个集合实现两种排序方式，比如一个song对象中的歌名和歌手名分别采用一种排序方法的话，我们可以重写compareTo方法和使用自制的Comparator方法或者以两个Comparator来实现歌名排序和歌星名排序，第二种代表我们只能使用两个参数版的Collections.sort().</p> <h3 id="collection-和-collections-有什么区别"><a href="#collection-和-collections-有什么区别" class="header-anchor">#</a> Collection 和 Collections 有什么区别？</h3> <ul><li>java.util.Collection 是一个集合接口（集合类的一个顶级接口）。它提供了对集合对象进行基本操作的通用接口方法。Collection接口在Java 类库中有很多具体的实现。Collection接口的意义是为各种具体的集合提供了 大化的统一操作方式，其直接继承接口有List与Set。</li> <li>Collections则是集合类的一个工具类/帮助类，其中提供了一系列静态方法，用于对集合中元素进行排序、搜索以及线程安全等各种操作。</li></ul> <h3 id="treemap-和-treeset-在排序时如何比较元素-collections-工具类中的-sort-方法如何比较元素"><a href="#treemap-和-treeset-在排序时如何比较元素-collections-工具类中的-sort-方法如何比较元素" class="header-anchor">#</a> TreeMap 和 TreeSet 在排序时如何比较元素？ Collections 工具类中的 sort()方法如何比较元素？</h3> <p>TreeSet 要求存放的对象所属的类必须实现 Comparable 接口，该接口提供了比较元素的 compareTo()方法，当插入元素时会回调该方法比较元素的大小。</p> <p>TreeMap 要求存放的键值对映射的键必须实现 Comparable 接口从而根据键对元素进 行排 序。</p> <p>Collections 工具类的 sort 方法有两种重载的形式，</p> <p>第一种要求传入的待排序容器中存放的对象比较实现 Comparable 接口以实现元素的比较；</p> <p>第二种不强制性的要求容器中的元素必须可比较，但是要求传入第二个参数，参数是Comparator 接口的子类型（需要重写 compare 方法实现元素的比较），相当于一个临时定义的排序规则，其实就是通过接口注入比较元素大小的算法，也是对回调模式的应用（Java 中对函数式编程的支持）。</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">5/24/2021, 8:31:13 PM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.42575a28.js" defer></script><script src="/assets/js/2.0d7d09b8.js" defer></script><script src="/assets/js/109.35619cf9.js" defer></script>
  </body>
</html>
