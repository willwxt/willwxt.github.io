(window.webpackJsonp=window.webpackJsonp||[]).push([[71],{426:function(s,t,a){"use strict";a.r(t);var n=a(45),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h3",{attrs:{id:"docker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker"}},[s._v("#")]),s._v(" Docker")]),s._v(" "),a("ol",[a("li",[s._v("前提知识 : 熟悉Linux命令和相关背景知识 ps top")])]),s._v(" "),a("h4",{attrs:{id:"docker简介"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker简介"}},[s._v("#")]),s._v(" Docker简介")]),s._v(" "),a("h5",{attrs:{id:"docker的基本组成"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker的基本组成"}},[s._v("#")]),s._v(" Docker的基本组成")]),s._v(" "),a("ol",[a("li",[s._v("镜像 image - 一个只读的模板, 用于创建Docker容器, 一个模板可以创建很大容器")]),s._v(" "),a("li",[s._v("容器 container -\n"),a("ul",[a("li",[s._v("Docker利用容器独立运行应用, 可以启动开始停止删除, 互相隔离, 保证安全")]),s._v(" "),a("li",[s._v("简易版的Linux环境")])])]),s._v(" "),a("li",[s._v("仓库 repository - 集中存放镜像文件的场所\n"),a("ul",[a("li",[s._v("仓库注册服务器Registry上往往存放着多个仓库")]),s._v(" "),a("li",[s._v("仓库分为公开public和私有private")])])])]),s._v(" "),a("ul",[a("li",[s._v("总结: Docker运行载体/引擎 - images - container - repository")])]),s._v(" "),a("h5",{attrs:{id:"安装步骤"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装步骤"}},[s._v("#")]),s._v(" 安装步骤")]),s._v(" "),a("ul",[a("li",[s._v("安装步骤, 可以参考 "),a("a",{attrs:{href:""}},[s._v("官网的中文安装手册")])])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("yum -y "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" gcc\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装gcc 和 gcc-c++")]),s._v("\nyum -y isstall gcc-c++\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 卸载旧版本")]),s._v("\nyum -y remove docker docker-common docker-selinux docker-engine\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装需要的软件包")]),s._v("\nyum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y yum-utils device-mapper-persistent-data lvm2\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置stable镜像仓库")]),s._v("\nyum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo\nyum makecache fast\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 更新yum软件包索引")]),s._v("\nyum -y "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" docker-ce\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装DOCKER CE")]),s._v("\nsystemctl start docker\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动docker")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("ul",[a("li",[s._v("配置镜像加速")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p /etc/docker\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/docker/daemon.json\nsystemctl daemon-reload\nsystemctl restart docker\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"registry-mirrors"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://61hd6hdm.mirror.aliyuncs.com"')]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("ul",[a("li",[s._v("卸载")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("systemctl stop docker\nyum -y remove docker-ce\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf /var/lib/docker\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("ul",[a("li",[a("a",{attrs:{href:"https://cr.console.aliyun.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("阿里云镜像加速"),a("OutboundLink")],1)])]),s._v(" "),a("h4",{attrs:{id:"docker常用命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker常用命令"}},[s._v("#")]),s._v(" Docker常用命令")]),s._v(" "),a("h6",{attrs:{id:"帮助命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#帮助命令"}},[s._v("#")]),s._v(" 帮助命令")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("docker version\ndocker info\ndocker --help\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h6",{attrs:{id:"镜像命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#镜像命令"}},[s._v("#")]),s._v(" 镜像命令")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("docker images\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 列出本地主机上的镜像")]),s._v("\ndocker images -a\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 流出本地所有的镜像(含中间镜像)")]),s._v("\ndocker images -q\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 只显示镜像id")]),s._v("\ndocker images --digests\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 摘要信息")]),s._v("\ndocker images --no-trunc\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 显示完整的镜像信息")]),s._v("\n\ndocker search "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("选项"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("镜像名"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 镜像库中搜索对应的images")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 选项: --no-trunc\t-s:列出收藏数不小于指定值\t--automated:只列出autobuild类型的镜像")]),s._v("\ndocker pull "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("镜像名:TAG"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 下载镜像")]),s._v("\n\ndocker rmi "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("镜像名/id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#删除镜像")]),s._v("\ndocker rmi -f "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("镜像id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#删除单个")]),s._v("\ndocker rmi -f "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("镜像名1:TAG 镜像名2:TAG "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("."),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#批量删除")]),s._v("\ndocker rmi -f "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("docker images -qa"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#删除全部")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("h6",{attrs:{id:"容器命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#容器命令"}},[s._v("#")]),s._v(" 容器命令")]),s._v(" "),a("ul",[a("li",[s._v("有镜像才能创建容器, 这是根本前提 "),a("code",[s._v("docker pull centos #用于演示")])])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("docker run "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("选项"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("镜像"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("命令"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("arg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 新建并启动容器")]),s._v("\ndocker run -it centos /bin/bash\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用镜像centos:latest以交互模式启动容器, 在容器内执行/bin/bash命令")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 选项说明: -d 后台运行 -i 以交互模式运行 -t 为容器分配伪输入终端 -P随机端口映射 -p指定端口映射 ip:hostPort:containerPort")]),s._v("\n\ndocker "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("选项"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 列出正在运行的容器")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 选项说明: -a列出当前所有正在运行+历史上运行过的容器 -l显示最近创建的容器 -n显示最近n个创建的 -q静默模式只显示容器编号 --no-trunc不截断")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 退出容器")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v("\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 容器停止, 退出")]),s._v("\nctrl+P+Q\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 容器不停止, 退出")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 容器状态")]),s._v("\ndocker start "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("容器id/容器name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动容器")]),s._v("\ndocker restart "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("容器id/容器name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重启容器")]),s._v("\ndocker stop "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("容器id/容器name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 停止容器")]),s._v("\ndocker "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("kill")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("容器id/容器name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 强制停止容器")]),s._v("\ndocker "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("容器id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除已停止的容器")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 批量删除容器")]),s._v("\ndocker "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -f "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("docker "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -a -q"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\ndocker "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -a -q "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("xargs")]),s._v(" docker "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("h6",{attrs:{id:"重要"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#重要"}},[s._v("#")]),s._v(" 重要")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("docker run -d centos\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用镜像centos:latest以后台模式启动一个容器")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Docker容器后台运行,就必须有一个前台进程")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 最佳的解决方案是,将你要运行的程序以前台进程的形式运行")]),s._v("\ndocker run -d centos /bin/sh -c "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"while true;do echo hello zzyy;sleep 2;done"')]),s._v("\n\ndocker logs -tf --tail "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("容器id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -t加入时间戳 -f实时更新 --tail 数字, 显示最后多少条")]),s._v("\n\ndocker "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("top")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("容器id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看容器内运行的细节")]),s._v("\n\ndocker "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("容器id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" /bin/bash\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 打开新的终端")]),s._v("\ndocker attach "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("容器id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入容器启动命令的终端")]),s._v("\n\ndocker "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("容器id:容器内路径"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("目的主机路径"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("h4",{attrs:{id:"docker镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker镜像"}},[s._v("#")]),s._v(" Docker镜像")]),s._v(" "),a("ul",[a("li",[s._v("Docker镜像是一层层加载, 每层是一次commit")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("docker commit\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 提交容器副本使之成为一个新的镜像")]),s._v("\ndocker commit -m"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("“提交的描述信息” -a"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("“作者” 容器ID 要创建的目标镜像名:"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("标签名"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 案例")]),s._v("\ndocker run -it -p "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v(":8080 tomcat\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 下载tomcat镜像到本地并运行")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这里打不开tomcat主页, 复制一下webapps.dist =>> webapps")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 提交镜像")]),s._v("\ndocker commit -m"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"add main"')]),s._v(" -a"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nampy"')]),s._v(" 6725d914bdb3 nampy/tomcat:1.0\ndocker images\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看新镜像")]),s._v("\ndocker run -it -p "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8888")]),s._v(":8080 nampy/tomcat:1.0\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 跑一下新镜像")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("h4",{attrs:{id:"docker容器数据卷"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker容器数据卷"}},[s._v("#")]),s._v(" Docker容器数据卷")]),s._v(" "),a("ul",[a("li",[s._v("容器持久化, 容器间继承, 共享数据")])]),s._v(" "),a("h6",{attrs:{id:"容器内添加数据卷"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#容器内添加数据卷"}},[s._v("#")]),s._v(" 容器内添加数据卷")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("docker run -it -v /dataVolume:/containerDataVolume centos /bin/bash\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -it -v /宿主机目录:/容器内目录 centos /bin/bash")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 可以读写")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -it -v /宿主机目录:/容器内目录:ro centos /bin/bash")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 此处:ro 只读")]),s._v("\n\ndocker inspect 容器ID\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看数据卷是否挂载成功")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"Mounts"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"Type"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bind"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"Source"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/home/nampy/app/dataVolume"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//连接上")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"Destination"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/containerDataVolumn"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"Mode"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"RW"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"Propagation"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"rprivate"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("ul",[a("li",[s._v("查看是否共享数据")]),s._v(" "),a("li",[s._v("容器停止后修改主机内容 , 重启容器查看是否同步")])]),s._v(" "),a("h6",{attrs:{id:"dockerfile添加"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile添加"}},[s._v("#")]),s._v(" DockerFile添加")]),s._v(" "),a("p",[s._v("使用DockerFile文件来添加数据卷")]),s._v(" "),a("div",{staticClass:"language-dockerfile line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# volume test")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" centos\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VOLUME")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/dataVolumeContainer1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/dataVolumeContainer2"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CMD")]),s._v(" echo "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"finished,--------success1"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CMD")]),s._v(" /bin/bash\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 用该文件挂载的卷, 默认挂载, 启动后使用 docker inspect id 来查看默认挂载路径")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("使用build命令构建镜像")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("docker build -f /mydocker/dockerFile -t nampy/centos "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 构建")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# successfully built ...\t获得新镜像")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("ul",[a("li",[s._v("问题 "),a("code",[s._v("cannot open directory .: Permission denied")])])]),s._v(" "),a("h6",{attrs:{id:"数据卷容器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#数据卷容器"}},[s._v("#")]),s._v(" 数据卷容器")]),s._v(" "),a("p",[s._v("继承关系")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 先启动dc01")]),s._v("\ndocker run -it --name dc01 nampy/centos\t\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 此处不加/bin/bash是因为dockerfile中已经有写了")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动dc02, dc03, 继承dc01 的数据卷")]),s._v("\ndocker run -it --name dc02 --volumes-from dc01 nampy/centos\ndocker run -it --name dc03 --volumes-from dc01 nampy/centos\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除dc01, 发现dc02和dc03还是能共享, 新建dc04继承dc03, 都能共享")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 总结: 容器之间的数据卷的继承会持续到没有容器使用它为止")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("ul",[a("li",[s._v("总结: 容器之间的数据卷的继承会持续到没有容器使用它为止")])]),s._v(" "),a("h4",{attrs:{id:"dockerfile解析"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile解析"}},[s._v("#")]),s._v(" DockerFile解析")]),s._v(" "),a("h6",{attrs:{id:"概述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#概述"}},[s._v("#")]),s._v(" 概述")]),s._v(" "),a("ul",[a("li",[s._v("用来构建Docker镜像的构建文件, 由一系列命令和参数构成的脚本")]),s._v(" "),a("li",[s._v("步骤: 编写DockerFile - docker build - docker run")])]),s._v(" "),a("h6",{attrs:{id:"dockerfile构建过程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile构建过程"}},[s._v("#")]),s._v(" DockerFile构建过程")]),s._v(" "),a("ul",[a("li",[s._v("DockerFil内容")])]),s._v(" "),a("ol",[a("li",[s._v("每条保留字指令都必须为大写, 必须跟随参数")]),s._v(" "),a("li",[s._v("指令从上往下顺序执行")]),s._v(" "),a("li",[a("code",[s._v("# 注释")])]),s._v(" "),a("li",[s._v("每条指令都会创建一个新的镜像层并提交")])]),s._v(" "),a("ul",[a("li",[s._v("Docker执行DockerFile过程")])]),s._v(" "),a("ol",[a("li",[s._v("docker从基础镜像运行一个容器")]),s._v(" "),a("li",[s._v("执行一条指令并对容器做出修改")]),s._v(" "),a("li",[s._v("执行类似docker commit操作, 提交新的镜像层")]),s._v(" "),a("li",[s._v("再基于刚提交的镜像运行一个新容器")]),s._v(" "),a("li",[s._v("顺序执行知道所有指令都执行完成")])]),s._v(" "),a("h6",{attrs:{id:"dockerfile体系结构-保留字指令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile体系结构-保留字指令"}},[s._v("#")]),s._v(" DockerFile体系结构(保留字指令)")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("指令")]),s._v(" "),a("th",[s._v("说明")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("FROM")]),s._v(" "),a("td",[s._v("基础镜像, 基于哪个镜像")])]),s._v(" "),a("tr",[a("td",[s._v("MAINTAINER")]),s._v(" "),a("td",[s._v("镜像维护者, 姓名, 邮箱地址")])]),s._v(" "),a("tr",[a("td",[s._v("RUN")]),s._v(" "),a("td",[s._v("容器构建时候运行的命令")])]),s._v(" "),a("tr",[a("td",[s._v("EXPOSE")]),s._v(" "),a("td",[s._v("容器对外暴露的端口")])]),s._v(" "),a("tr",[a("td",[s._v("WORKDIR")]),s._v(" "),a("td",[s._v("工作目录, 终端登录的默认文件路径")])]),s._v(" "),a("tr",[a("td",[s._v("ENV")]),s._v(" "),a("td",[s._v("构建镜像过程中设置环境变量")])]),s._v(" "),a("tr",[a("td",[s._v("ADD")]),s._v(" "),a("td",[s._v("将宿主机目录下的文件拷贝进镜像, 自动处理URL,TAR")])]),s._v(" "),a("tr",[a("td",[s._v("COPY")]),s._v(" "),a("td",[s._v("类似ADD, 拷贝目录或文件到镜像")])]),s._v(" "),a("tr",[a("td",[s._v("VOLUME")]),s._v(" "),a("td",[s._v("数据卷")])]),s._v(" "),a("tr",[a("td",[s._v("CMD")]),s._v(" "),a("td",[s._v("指定容器启动时的命令")])]),s._v(" "),a("tr",[a("td",[s._v("ENTRYPOINT")]),s._v(" "),a("td",[s._v("目的和CMD一样, 指定容器启动程序和参数")])]),s._v(" "),a("tr",[a("td",[s._v("ONBUILD")]),s._v(" "),a("td",[s._v("当构建一个被继承的DockerFiler时运行命令")])])])]),s._v(" "),a("h6",{attrs:{id:"案例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#案例"}},[s._v("#")]),s._v(" 案例")]),s._v(" "),a("ul",[a("li",[s._v("连接不上8080端口的原因是没有重启docker服务...")])])])}),[],!1,null,null,null);t.default=e.exports}}]);